import{a5 as k,r as n,a6 as w,j as e,v as a,K as x}from"./index.fe43fbf5.js";import{C as _,b,T as N,Q as v,V as D,W as $,Y as T,Z as S}from"./App.9644e084.js";import{P as I}from"./planet.7b97fcd0.js";import{h as C}from"./moment.68d8b8f0.js";function j(){const{statusId:r}=k(),[o,p]=n.exports.useState([]),[g,m]=n.exports.useState(!0),[l,u]=n.exports.useState(null),f=w();return n.exports.useEffect(()=>{(async()=>{try{const d=localStorage.getItem("authToken"),s=localStorage.getItem("user_role"),c=localStorage.getItem("user_id");if(!d){window.location.href="/login";return}let i="";s==="manager"||s==="hr"?i=`https://bapi.reownlogics.com/api/help-desk?manager_status_id=${r}&department_manager_id=${c}`:s==="employee"?i=`https://bapi.reownlogics.com/api/help-desk?employee_status_id=${r}&employee_id=${c}`:s==="assistant"&&(i=`https://bapi.reownlogics.com/api/help-desk?assigned_to_id=${c}&assigned_status_id=${r}`);const h=await x.get(i,{headers:{Authorization:`Bearer ${d}`}});p(h.data),console.log("response of tickets",h.data)}catch{u("Failed to fetch tickets")}finally{m(!1)}})()},[r]),g?e("div",{children:"Loading tickets..."}):l?e("div",{className:"text-danger",children:l}):e("div",{children:e(_,{className:"bg-white ticket-card",children:e(b,{children:a(N,{striped:!0,responsive:!0,children:[e("thead",{children:a("tr",{children:[e("th",{children:"Name"}),e("th",{children:"Description"}),r==="4"&&e("th",{children:"Rating"}),e("th",{children:"Department"}),e("th",{children:"Created At"}),e("th",{children:"Actions"})]})}),e("tbody",{children:o.length>0?o.map(t=>a("tr",{children:[e("td",{children:t.title}),e("td",{children:t.description.length>3?`${t.description.slice(0,30)}...`:t.description}),r==="4"&&e("td",{children:t.reviews.length>0?t.reviews[0].rating:"No rating"}),e("td",{children:t.department.name}),e("td",{children:e("span",{style:{background:"#daf1df",padding:"6px",borderRadius:"100px"},children:C(t.created_at).format("YYYY-MM-DD hh:mm:ss A")})}),e("td",{children:a(v,{children:[e(D,{className:"pe-1",tag:"span",children:e($,{size:15})}),e(T,{end:!0,children:e(S,{onClick:()=>f(`/ticket-detail/${t.id}`),children:e("span",{className:"align-middle ms-50",children:"Detail"})})})]})})]},t.id)):e("tr",{children:e("td",{colSpan:"6",className:"text-center",children:a("div",{className:"card bg-white text-center",children:[e("img",{src:I,height:400,width:400,className:"mx-auto d-block",alt:"Planet"}),e("h2",{children:"No tickets found"})]})})})})]})})})})}export{j as default};
