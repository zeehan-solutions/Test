import{r as i,K as H,j as e,M as K,v as a}from"./index.4455fcbe.js";import{s as W,S as y,N as X,i as T,j as S,C as Y,k as Z,l as I,I as j,f as L,g as A,h as R}from"./App.e864e2a1.js";import"./moment.ef14f9cc.js";import{C as ee}from"./createhelpdesk.cab6b217.js";import{c as te,C as ne,a as ae,b as se,d as re,e as ie,T as $}from"./tickettable.b2d90a3c.js";import{B as ce}from"./Backbutton.c79d50ef.js";import"./CardTitle.05eaf1f6.js";function le(){var P,_,D,E,b,r,B,h,v,p;const[t,l]=i.exports.useState(null),f=H(),g=async()=>{try{const s=localStorage.getItem("authToken"),o=localStorage.getItem("user_id");if(!s){window.location.href="/login",console.error("No token found, please login.");return}const u=await K.get(`https://bapi.reownlogics.com/api/assistant_dashboard/${o}`,{headers:{Authorization:`Bearer ${s}`}});l(u.data||{})}catch(s){console.error("Error fetching ticket stats:",s),l({})}};if(i.exports.useEffect(()=>{g()},[]),t===null)return e("div",{className:"text-center p-2",children:"Loading stats..."});if(!Object.values(t).some(s=>typeof s=="number"&&s>0))return e("div",{className:"text-center p-4",children:"No stats available"});const d=[{key:"total_tickets",label:"Total Tickets",value:(P=t==null?void 0:t.total_tickets)!=null?P:0,percentage:(_=t==null?void 0:t.percentage_change_total)!=null?_:0,img:te,trend:(t==null?void 0:t.percentage_change_total)>0?"up":(t==null?void 0:t.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(D=t==null?void 0:t.completed_tickets)!=null?D:0,percentage:(E=t==null?void 0:t.percentage_change_completed)!=null?E:0,img:ne,trend:(t==null?void 0:t.percentage_change_completed)>0?"up":(t==null?void 0:t.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(b=t==null?void 0:t.pending_tickets)!=null?b:0,percentage:(r=t==null?void 0:t.percentage_change_pending)!=null?r:0,img:ae,trend:(t==null?void 0:t.percentage_change_pending)>0?"up":(t==null?void 0:t.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(B=t==null?void 0:t.inprogress_tickets)!=null?B:0,percentage:(h=t==null?void 0:t.percentage_change_inprogress)!=null?h:0,img:se,trend:(t==null?void 0:t.percentage_change_inprogress)>0?"up":(t==null?void 0:t.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(v=t==null?void 0:t.reopen_tickets)!=null?v:0,percentage:(p=t==null?void 0:t.percentage_change_reopen)!=null?p:0,img:re,trend:(t==null?void 0:t.percentage_change_reopen)>0?"up":(t==null?void 0:t.percentage_change_reopen)<0?"down":"neutral"}],m={"Pending Tickets":2,"In Progress Tickets":"progress","Completed Tickets":"completed",Reopen:"reopen","Closed-Rejected":7};return e("div",{children:e(ie,{ticketData:d,handleCardClick:s=>{const o=m[s];s==="In Progress Tickets"?f(`/assistantprogress/${o}`):s==="Completed Tickets"?f(`/assistantview/${o}`):s==="Reopen"?f(`/assistantview/${o}`):o&&f(`/rolestats/${o}`)}})})}W.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;const fe=()=>{const t=H(),[l,f]=i.exports.useState(!1),[g,z]=i.exports.useState([]),[d,m]=i.exports.useState(""),[M,P]=i.exports.useState("newest"),[_,D]=i.exports.useState([]);i.exports.useState(!1);const[E,b]=i.exports.useState(!1),[r,B]=i.exports.useState("1"),[h,v]=i.exports.useState(!1),p=n=>{r!==n&&(B(n),v(!0))},s=async()=>{v(!0);try{const n=localStorage.getItem("authToken"),c=localStorage.getItem("user_id");if(!n){t("/login"),console.error("No token found, please login.");return}let k="https://bapi.reownlogics.com/api/help-desk",C={assigned_to_id:c};const O={4:2};r==="2"&&(k=`https://bapi.reownlogics.com/api/help-desk/completed_by_assistant/${c}`,C={}),r==="3"&&(k=`https://bapi.reownlogics.com/api/help-desk?employee_status_id=2&assigned_to_id=${c}`,C={}),r==="5"?(k=`https://bapi.reownlogics.com/api/help-desk/reopen_tickets_for_assistant/${c}`,C={}):O[r]&&(C={assigned_status_id:O[r],assigned_to_id:c});const G=await K.get(k,{params:C,headers:{Authorization:`Bearer ${n}`}});let U=G.data;U.sort((J,Q)=>new Date(Q.created_at)-new Date(J.created_at)),D(U.slice(0,5)),console.log("employee data data",G.data)}catch(n){console.error("Error fetching employee data: ",n)}finally{b(!1),v(!1)}};i.exports.useEffect(()=>{s()},[r]),i.exports.useEffect(()=>{b(!0),s()},[]);const o=(n,c)=>M==="newest"?new Date(c.createdAt)-new Date(n.createdAt):M==="oldest"?new Date(n.createdAt)-new Date(c.createdAt):0,u=_.filter(n=>n.title.toLowerCase().includes(d.toLowerCase())).sort(o),N=()=>{f(!l),z(l?[]:_.map(n=>n.id))},w=n=>{z(c=>c.includes(n)?c.filter(k=>k!==n):[...c,n])},[V,q]=i.exports.useState(!1),F=()=>{q(!V)};if(E)return a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[e(y,{}),e("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]});const x=()=>{t(`/allassistanttickets?tab=${r}`)};return a("div",{children:[e(ce,{}),e("div",{className:"d-flex justify-content-end align-items-center",children:e(ee,{isOpen:V,toggle:F,refreshTickets:s})}),e(le,{}),a(X,{tabs:!0,className:"my-3",children:[e(T,{className:"navbarItem",children:e(S,{className:"navbarLink",active:r==="1",onClick:()=>{p("1")},children:"New"})}),e(T,{className:"navbarItem",children:e(S,{className:"navbarLink",active:r==="4",onClick:()=>{p("4")},children:"Unassigned"})}),e(T,{className:"navbarItem",children:e(S,{className:"navbarLink",active:r==="3",onClick:()=>{p("3")},children:"Assigned / Unresolved"})}),e(T,{className:"navbarItem",children:e(S,{className:"navbarLink",active:r==="5",onClick:()=>{p("5")},children:"Reopened"})}),e(T,{className:"navbarItem",children:e(S,{className:"navbarLink",active:r==="2",onClick:()=>{p("2")},children:"Resolved"})})]}),e(Y,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:a(Z,{activeTab:r,children:[a(I,{tabId:"1",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"New Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:l,selectedRows:g,handleSelectRow:w,handleSelectAll:N,refreshTickets:s})]}),a(I,{tabId:"2",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Resolved Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:l,selectedRows:g,handleSelectRow:w,handleSelectAll:N,refreshTickets:s})]}),a(I,{tabId:"3",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Assigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:l,selectedRows:g,handleSelectRow:w,handleSelectAll:N,refreshTickets:s})]}),a(I,{tabId:"4",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Unassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:l,selectedRows:g,handleSelectRow:w,handleSelectAll:N,refreshTickets:s})]}),a(I,{tabId:"5",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reopened Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:l,selectedRows:g,handleSelectRow:w,handleSelectAll:N,refreshTickets:s})]})]})})]})};export{fe as default};
