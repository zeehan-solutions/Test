import{r as a,K as A,j as n,M as D,v as s,L as B}from"./index.646e8ac6.js";import{s as M,S as $,C as P,I as O,f as z,g as G,h as H}from"./App.954e6202.js";import{C as K}from"./createhelpdesk.82c3a433.js";import{c as V,C as q,a as F,b as J,d as Q,e as U,t as W}from"./tickettable.3f47a7bc.js";import{C as X}from"./c6.4d79638f.js";import"./moment.ef14f9cc.js";import"./CardTitle.a3f9ac64.js";function Y(){var I,d,_,f,p,o,g,k,y,w,S,h;const[e,i]=a.exports.useState(null),u=A(),b=async()=>{try{const r=localStorage.getItem("authToken"),l=localStorage.getItem("user_id");if(!r){window.location.href="/login",console.error("No token found, please login.");return}const C=await D.get(`https://bapi.reownlogics.com/api/employee_dashboard/${l}`,{headers:{Authorization:`Bearer ${r}`}});i(C.data||{})}catch(r){console.error("Error fetching ticket stats:",r),i({})}};if(a.exports.useEffect(()=>{b()},[]),e===null)return n("div",{className:"d-flex justify-content-center align-items-center gap-2 mb-2",children:"Loading Stats..."});if(!Object.values(e).some(r=>typeof r=="number"&&r>0))return n("div",{className:"text-center p-4",children:"No stats available"});const m=[{key:"total_tickets",label:"Total Tickets",value:(I=e==null?void 0:e.total_tickets)!=null?I:0,percentage:(d=e==null?void 0:e.percentage_change_total)!=null?d:0,img:V,trend:(e==null?void 0:e.percentage_change_total)>0?"up":(e==null?void 0:e.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(_=e==null?void 0:e.completed_tickets)!=null?_:0,percentage:(f=e==null?void 0:e.percentage_change_completed)!=null?f:0,img:q,trend:(e==null?void 0:e.percentage_change_completed)>0?"up":(e==null?void 0:e.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(p=e==null?void 0:e.pending_tickets)!=null?p:0,percentage:(o=e==null?void 0:e.percentage_change_pending)!=null?o:0,img:F,trend:(e==null?void 0:e.percentage_change_pending)>0?"up":(e==null?void 0:e.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(g=e==null?void 0:e.inprogress_tickets)!=null?g:0,percentage:(k=e==null?void 0:e.percentage_change_inprogress)!=null?k:0,img:J,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(y=e==null?void 0:e.reopen_tickets)!=null?y:0,percentage:(w=e==null?void 0:e.percentage_change_reopen)!=null?w:0,img:Q,trend:(e==null?void 0:e.percentage_change_reopen)>0?"up":(e==null?void 0:e.percentage_change_reopen)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(S=e==null?void 0:e.closed_tickets)!=null?S:0,percentage:(h=e==null?void 0:e.percentage_change_closed)!=null?h:0,img:X,trend:(e==null?void 0:e.percentage_change_closed)>0?"up":(e==null?void 0:e.percentage_change_closed)<0?"down":"neutral"}],T={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7};return n("div",{children:n(U,{ticketData:m,handleCardClick:r=>{const l=T[r];r==="In Progress Tickets"?u("/in-progress-tickets"):l&&u(`/tickets/${l}`)}})})}const R=M.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,ce=()=>{const e=A(),[i,u]=a.exports.useState(!1),[b,v]=a.exports.useState([]),[m,T]=a.exports.useState(""),[N,I]=a.exports.useState("newest"),[d,_]=a.exports.useState([]);a.exports.useState(!1);const[f,p]=a.exports.useState(!1),o=localStorage.getItem("user_role"),g=async()=>{try{const t=localStorage.getItem("authToken"),c=localStorage.getItem("user_id");if(!t){e("/login"),console.error("No token found, please login.");return}const x=await D.get("https://bapi.reownlogics.com/api/help-desk",{params:{employee_id:c},headers:{Authorization:`Bearer ${t}`}});let j=x.data;j.sort((L,E)=>new Date(E.created_at)-new Date(L.created_at)),_(j.slice(0,5)),console.log("employee data data",x.data)}catch(t){console.error("Error fetching employee data: ",t)}finally{p(!1)}};a.exports.useEffect(()=>{p(!0),g()},[]);const k=(t,c)=>N==="newest"?new Date(c.createdAt)-new Date(t.createdAt):N==="oldest"?new Date(t.createdAt)-new Date(c.createdAt):0,y=d.filter(t=>t.title.toLowerCase().includes(m.toLowerCase())).sort(k),w=()=>{u(!i),v(i?[]:d.map(t=>t.id))},S=t=>{v(c=>c.includes(t)?c.filter(x=>x!==t):[...c,t])},[h,r]=a.exports.useState(!1),l=()=>{r(!h)},C=()=>{const t=localStorage.getItem("user_id");o==="assistant"?e(`/assistant_dashboard/${t}`):(o==="manager"||o==="hr")&&e(`/manager_dashboard/${t}`)};return f?s("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[n($,{}),n("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]}):s("div",{children:[s("div",{className:"d-flex justify-content-end align-items-center mb-2",children:[o==="assistant"&&n(R,{onClick:C,children:"Assigned Tickets"}),(o==="manager"||o==="hr")&&n(R,{onClick:C,children:"Managed Tickets"}),n(R,{onClick:l,className:"ms-1",children:"+ Create New"}),n(K,{isOpen:h,toggle:l,refreshTickets:g})]}),n(Y,{}),s(P,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:[s("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[n("div",{children:n("h3",{children:"Recent Ticket"})}),s("div",{className:"d-flex align-items-center justify-content-end",children:[s(O,{className:"mr-3",children:[n(z,{style:{borderRight:0},children:n(G,{size:16})}),n(H,{placeholder:"Search here ....",value:m,onChange:t=>T(t.target.value),style:{borderLeft:0}})]}),n(B,{to:"/alltickets",style:{},className:"ms-1 viewall",children:"View All"})]})]}),n(W,{filteredEmployees:y,selectAll:i,selectedRows:b,handleSelectRow:S,handleSelectAll:w})]})]})};export{ce as default};
