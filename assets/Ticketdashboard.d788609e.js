import{r as o,K as j,j as t,v as a,M as A,L as $}from"./index.0e991307.js";import{R as E,c as P,C as B,b as z,s as F,S as O,I as Y,f as G,g as U,h as H,T as W,Z as K,$ as V,a0 as Z,a1 as q,a2 as J}from"./App.f2f7ddbf.js";import{h as Q}from"./ticketstable.c660ffcc.js";import{C as X}from"./createhelpdesk.23221a72.js";import{C as ee,a as te}from"./CardTitle.7106e3ec.js";import{c as ne,C as re,a as ae,b as ce,d as oe,I as le,e as se}from"./c5.27a2ef20.js";import{C as ie}from"./c6.4d79638f.js";function de(){var D,d,k,_,p,l,g,w,b,x,y,h;const[e,i]=o.exports.useState(null),u=j(),v=async()=>{try{const r=localStorage.getItem("authToken"),s=localStorage.getItem("user_id");if(!r){window.location.href="/login",console.error("No token found, please login.");return}const C=await A.get(`https://bapi.reownlogics.com/api/employee_dashboard/${s}`,{headers:{Authorization:`Bearer ${r}`}});i(C.data||{})}catch(r){console.error("Error fetching ticket stats:",r),i({})}};if(o.exports.useEffect(()=>{v()},[]),e===null)return t("div",{className:"d-flex justify-content-center align-items-center gap-2 mb-2",children:"Loading Stats..."});if(!Object.values(e).some(r=>typeof r=="number"&&r>0))return t("div",{className:"text-center p-4",children:"No stats available"});const m=[{key:"total_tickets",label:"Total Tickets",value:(D=e==null?void 0:e.total_tickets)!=null?D:0,percentage:(d=e==null?void 0:e.percentage_change_total)!=null?d:0,img:ne,trend:(e==null?void 0:e.percentage_change_total)>0?"up":(e==null?void 0:e.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(k=e==null?void 0:e.completed_tickets)!=null?k:0,percentage:(_=e==null?void 0:e.percentage_change_completed)!=null?_:0,img:re,trend:(e==null?void 0:e.percentage_change_completed)>0?"up":(e==null?void 0:e.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(p=e==null?void 0:e.pending_tickets)!=null?p:0,percentage:(l=e==null?void 0:e.percentage_change_pending)!=null?l:0,img:ae,trend:(e==null?void 0:e.percentage_change_pending)>0?"up":(e==null?void 0:e.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(g=e==null?void 0:e.inprogress_tickets)!=null?g:0,percentage:(w=e==null?void 0:e.percentage_change_inprogress)!=null?w:0,img:ce,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(b=e==null?void 0:e.reopen_tickets)!=null?b:0,percentage:(x=e==null?void 0:e.percentage_change_reopen)!=null?x:0,img:oe,trend:(e==null?void 0:e.percentage_change_reopen)>0?"up":(e==null?void 0:e.percentage_change_reopen)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(y=e==null?void 0:e.closed_tickets)!=null?y:0,percentage:(h=e==null?void 0:e.percentage_change_closed)!=null?h:0,img:ie,trend:(e==null?void 0:e.percentage_change_closed)>0?"up":(e==null?void 0:e.percentage_change_closed)<0?"down":"neutral"}],T={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7},f=r=>{const s=T[r];r==="In Progress Tickets"?u("/in-progress-tickets"):s&&u(`/tickets/${s}`)};return t("div",{children:t(E,{children:m.map((r,s)=>t(P,{sm:"6",md:"4",children:t(B,{className:"ticket-card bg-white",onClick:()=>f(r.label),style:{borderRadius:"30px"},children:a(z,{children:[a("div",{className:"d-flex justify-content-between",children:[a(ee,{tag:"h6",className:"pe-auto",style:{fontSize:"16px",color:"#202224"},children:[r.label,t("h3",{className:"mt-2",style:{fontSize:"35px",fontWeight:"bold"},children:r.value})]}),r.img&&t("img",{src:r.img,alt:"Icon",style:{width:60,height:60,marginLeft:"10px"}})]}),a("div",{className:"d-flex align-items-center",children:[r.trend==="up"&&t(le,{size:16,style:{color:"#00B69B"}}),r.trend==="down"&&t(se,{size:16,style:{color:"#F93C65"}}),a("span",{className:"ms-1",style:{color:r.trend==="up"?"#00B69B":r.trend==="down"?"#F93C65":"#202224",fontSize:"16px",fontWeight:"bold"},children:[r.percentage,"%"]}),r.trend!=="neutral"&&t(te,{className:" ms-1",style:{fontSize:"16px",color:"#202224"},children:r.trend==="up"?"Up from yesterday":"Down from yesterday"})]})]})})},s))})})}const I=F.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,_e=()=>{const e=j(),[i,u]=o.exports.useState(!1),[v,N]=o.exports.useState([]),[m,T]=o.exports.useState(""),[f,D]=o.exports.useState("newest"),[d,k]=o.exports.useState([]);o.exports.useState(!1);const[_,p]=o.exports.useState(!1),l=localStorage.getItem("user_role"),g=async()=>{try{const n=localStorage.getItem("authToken"),c=localStorage.getItem("user_id");if(!n){e("/login"),console.error("No token found, please login.");return}const S=await A.get("https://bapi.reownlogics.com/api/help-desk",{params:{employee_id:c},headers:{Authorization:`Bearer ${n}`}});let R=S.data;R.sort((L,M)=>new Date(M.created_at)-new Date(L.created_at)),k(R.slice(0,5)),console.log("employee data data",S.data)}catch(n){console.error("Error fetching employee data: ",n)}finally{p(!1)}};o.exports.useEffect(()=>{p(!0),g()},[]);const w=(n,c)=>f==="newest"?new Date(c.createdAt)-new Date(n.createdAt):f==="oldest"?new Date(n.createdAt)-new Date(c.createdAt):0,b=d.filter(n=>n.title.toLowerCase().includes(m.toLowerCase())).sort(w),x=()=>{u(!i),N(i?[]:d.map(n=>n.id))},y=n=>{N(c=>c.includes(n)?c.filter(S=>S!==n):[...c,n])},[h,r]=o.exports.useState(!1),s=()=>{r(!h)},C=()=>{const n=localStorage.getItem("user_id");l==="assistant"?e(`/assistant_dashboard/${n}`):(l==="manager"||l==="hr")&&e(`/manager_dashboard/${n}`)};return _?a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[t(O,{}),t("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]}):a("div",{children:[a("div",{className:"d-flex justify-content-end align-items-center mb-2",children:[l==="assistant"&&t(I,{onClick:C,children:"Assigned Tickets"}),(l==="manager"||l==="hr")&&t(I,{onClick:C,children:"Managed Tickets"}),t(I,{onClick:s,className:"ms-1",children:"+ Create New"}),t(X,{isOpen:h,toggle:s,refreshTickets:g})]}),t(de,{}),a(B,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[t("div",{children:t("h3",{children:"Recent Ticket"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(Y,{className:"mr-3",children:[t(G,{style:{borderRight:0},children:t(U,{size:16})}),t(H,{placeholder:"Search here ....",value:m,onChange:n=>T(n.target.value),style:{borderLeft:0}})]}),t($,{to:"/alltickets",style:{},className:"ms-1 viewall",children:"View All"})]})]}),t(z,{children:a(W,{responsive:!0,className:"table-ticket",children:[t("thead",{children:a("tr",{children:[t("th",{children:t("input",{type:"checkbox",checked:i,onChange:x})}),t("th",{children:"Name"}),t("th",{children:"Description"}),t("th",{children:"Department"}),t("th",{children:"Created"}),t("th",{children:"Actions"})]})}),t("tbody",{children:b.map(n=>{var c;return a("tr",{children:[t("td",{children:t("input",{type:"checkbox",checked:v.includes(n.id),onChange:()=>y(n.id)})}),t("td",{children:n.title}),t("td",{children:((c=n==null?void 0:n.description)==null?void 0:c.length)>3?`${n.description.slice(0,30)}...`:n.description}),t("td",{children:n.department.name}),t("td",{children:t("span",{style:{background:"rgba(58, 151, 76, 0.1)",padding:"10px",borderRadius:"100px",color:"#3A974C"},children:Q(n.created_at).format("YYYY-MM-DD")})}),t("td",{children:a(K,{children:[t(V,{className:"pe-1",tag:"span",children:t(Z,{size:15,style:{color:"#605BFF"}})}),t(q,{end:!0,children:t(J,{onClick:()=>e(`/ticket-detail/${n.id}`),children:t("span",{className:"align-middle ms-50",children:"Detail"})})})]})})]},n.id)})})]})})]})]})};export{_e as default};
