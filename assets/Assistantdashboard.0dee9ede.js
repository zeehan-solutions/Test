import{r as i,K as H,j as e,M as K,v as a}from"./index.6f6a8d80.js";import{s as W,S as y,N as X,i as S,j as T,C as Y,k as Z,l as I,I as j,f as L,g as A,h as R}from"./App.c605b380.js";import"./moment.ef14f9cc.js";import{C as ee}from"./createhelpdesk.7d4db264.js";import{c as te,C as ne,a as ae,b as se,d as re,e as ie,T as $}from"./tickettable.748f5ad0.js";import{B as le}from"./Backbutton.039e979b.js";import"./CardTitle.290b3685.js";function ce(){var P,_,D,E,b,s,B,p,v,h;const[t,c]=i.exports.useState(null),f=H(),g=async()=>{try{const r=localStorage.getItem("authToken"),o=localStorage.getItem("user_id");if(!r){window.location.href="/login",console.error("No token found, please login.");return}const u=await K.get(`https://bapi.reownlogics.com/api/assistant_dashboard/${o}`,{headers:{Authorization:`Bearer ${r}`}});c(u.data||{})}catch(r){console.error("Error fetching ticket stats:",r),c({})}};if(i.exports.useEffect(()=>{g()},[]),t===null)return e("div",{className:"text-center p-2",children:"Loading stats..."});if(!Object.values(t).some(r=>typeof r=="number"&&r>0))return e("div",{className:"text-center p-4",children:"No stats available"});const d=[{key:"total_tickets",label:"Total Tickets",value:(P=t==null?void 0:t.total_tickets)!=null?P:0,percentage:(_=t==null?void 0:t.percentage_change_total)!=null?_:0,img:te,trend:(t==null?void 0:t.percentage_change_total)>0?"up":(t==null?void 0:t.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(D=t==null?void 0:t.completed_tickets)!=null?D:0,percentage:(E=t==null?void 0:t.percentage_change_completed)!=null?E:0,img:ne,trend:(t==null?void 0:t.percentage_change_completed)>0?"up":(t==null?void 0:t.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(b=t==null?void 0:t.pending_tickets)!=null?b:0,percentage:(s=t==null?void 0:t.percentage_change_pending)!=null?s:0,img:ae,trend:(t==null?void 0:t.percentage_change_pending)>0?"up":(t==null?void 0:t.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(B=t==null?void 0:t.inprogress_tickets)!=null?B:0,percentage:(p=t==null?void 0:t.percentage_change_inprogress)!=null?p:0,img:se,trend:(t==null?void 0:t.percentage_change_inprogress)>0?"up":(t==null?void 0:t.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(v=t==null?void 0:t.reopen_tickets)!=null?v:0,percentage:(h=t==null?void 0:t.percentage_change_reopen)!=null?h:0,img:re,trend:(t==null?void 0:t.percentage_change_reopen)>0?"up":(t==null?void 0:t.percentage_change_reopen)<0?"down":"neutral"}],m={"Pending Tickets":2,"In Progress Tickets":"progress","Completed Tickets":"completed",Reopen:"reopen","Closed-Rejected":7};return e("div",{children:e(ie,{ticketData:d,handleCardClick:r=>{const o=m[r];r==="In Progress Tickets"?f(`/assistantprogress/${o}`):r==="Completed Tickets"?f(`/assistantview/${o}`):r==="Reopen"?f(`/assistantview/${o}`):o&&f(`/rolestats/${o}`)}})})}W.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;const fe=()=>{const t=H(),[c,f]=i.exports.useState(!1),[g,z]=i.exports.useState([]),[d,m]=i.exports.useState(""),[M,P]=i.exports.useState("newest"),[_,D]=i.exports.useState([]);i.exports.useState(!1);const[E,b]=i.exports.useState(!1),[s,B]=i.exports.useState("1"),[p,v]=i.exports.useState(!1),h=n=>{s!==n&&(B(n),v(!0))},r=async()=>{v(!0);try{const n=localStorage.getItem("authToken"),l=localStorage.getItem("user_id");if(!n){t("/login"),console.error("No token found, please login.");return}let k="https://bapi.reownlogics.com/api/help-desk",C={assigned_to_id:l};const O={4:2};s==="2"&&(k=`https://bapi.reownlogics.com/api/help-desk/completed_by_assistant/${l}`,C={}),s==="3"&&(k=`https://bapi.reownlogics.com/api/help-desk?employee_status_id=2&assigned_to_id=${l}`,C={}),s==="5"?(k=`https://bapi.reownlogics.com/api/help-desk/reopen_tickets_for_assistant/${l}`,C={}):O[s]&&(C={assigned_status_id:O[s],assigned_to_id:l});const G=await K.get(k,{params:C,headers:{Authorization:`Bearer ${n}`}});let U=G.data;U.sort((J,Q)=>new Date(Q.created_at)-new Date(J.created_at)),D(U.slice(0,5)),console.log("employee data data",G.data)}catch(n){console.error("Error fetching employee data: ",n)}finally{b(!1),v(!1)}};i.exports.useEffect(()=>{r()},[s]),i.exports.useEffect(()=>{b(!0),r()},[]);const o=(n,l)=>M==="newest"?new Date(l.createdAt)-new Date(n.createdAt):M==="oldest"?new Date(n.createdAt)-new Date(l.createdAt):0,u=_.filter(n=>n.title.toLowerCase().includes(d.toLowerCase())).sort(o),N=()=>{f(!c),z(c?[]:_.map(n=>n.id))},w=n=>{z(l=>l.includes(n)?l.filter(k=>k!==n):[...l,n])},[V,q]=i.exports.useState(!1),F=()=>{q(!V)};if(E)return a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[e(y,{}),e("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]});const x=()=>{t(`/allassistanttickets?tab=${s}`)};return a("div",{children:[e(le,{}),e("div",{className:"d-flex justify-content-end align-items-center",children:e(ee,{isOpen:V,toggle:F,refreshTickets:r})}),e(ce,{}),a(X,{tabs:!0,className:"my-3",children:[e(S,{className:"navbarItem",children:e(T,{className:"navbarLink",active:s==="1",onClick:()=>{h("1")},children:"New"})}),e(S,{className:"navbarItem",children:e(T,{className:"navbarLink",active:s==="2",onClick:()=>{h("2")},children:"Resolved"})}),e(S,{className:"navbarItem",children:e(T,{className:"navbarLink",active:s==="3",onClick:()=>{h("3")},children:"Assigned / Unresolved"})}),e(S,{className:"navbarItem",children:e(T,{className:"navbarLink",active:s==="4",onClick:()=>{h("4")},children:"Unassigned"})}),e(S,{className:"navbarItem",children:e(T,{className:"navbarLink",active:s==="5",onClick:()=>{h("5")},children:"Reopened"})})]}),e(Y,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:a(Z,{activeTab:s,children:[a(I,{tabId:"1",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"New Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),p?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:c,selectedRows:g,handleSelectRow:w,handleSelectAll:N})]}),a(I,{tabId:"2",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Resolved Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),p?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:c,selectedRows:g,handleSelectRow:w,handleSelectAll:N})]}),a(I,{tabId:"3",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Assigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),p?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:c,selectedRows:g,handleSelectRow:w,handleSelectAll:N})]}),a(I,{tabId:"4",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Unassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),p?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:c,selectedRows:g,handleSelectRow:w,handleSelectAll:N})]}),a(I,{tabId:"5",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reopened Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[e(L,{style:{borderRight:0},children:e(A,{size:16})}),e(R,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:x,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),p?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(y,{})}):e($,{filteredEmployees:u,selectAll:c,selectedRows:g,handleSelectRow:w,handleSelectAll:N})]})]})})]})};export{fe as default};
