import{r as c,K as F,j as e,M as H,v as a,L as W}from"./index.4455fcbe.js";import{s as X,S as v,N as Y,i as k,j as y,C as Z,k as ee,l as b,I as N,f as _,g as x,h as w}from"./App.e864e2a1.js";import"./moment.ef14f9cc.js";import{C as te}from"./createhelpdesk.cab6b217.js";import{c as ne,C as ae,a as re,b as le,d as ce,e as se,T as C}from"./tickettable.b2d90a3c.js";import{C as ie}from"./c6.4d79638f.js";import{B as oe}from"./Backbutton.c79d50ef.js";import"./CardTitle.05eaf1f6.js";function de(){var M,S,L,R,j,r,A,g,I,p,s,D;const[t,i]=c.exports.useState(null),E=F(),m=async()=>{try{const l=localStorage.getItem("authToken"),o=localStorage.getItem("user_id");if(!l){window.location.href="/login",console.error("No token found, please login.");return}const f=await H.get(`https://bapi.reownlogics.com/api/manager_dashboard/${o}`,{headers:{Authorization:`Bearer ${l}`}});i(f.data||{})}catch(l){console.error("Error fetching ticket stats:",l),i({})}};if(c.exports.useEffect(()=>{m()},[]),t===null)return e("div",{className:"text-center p-2",children:"Loading stats..."});if(!Object.values(t).some(l=>typeof l=="number"&&l>0))return e("div",{className:"text-center p-4",children:"No stats available"});const h=[{key:"total_tickets",label:"Total Tickets",value:(M=t==null?void 0:t.total_tickets)!=null?M:0,percentage:(S=t==null?void 0:t.percentage_change_total)!=null?S:0,img:ne,trend:(t==null?void 0:t.percentage_change_total)>0?"up":(t==null?void 0:t.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(L=t==null?void 0:t.completed_tickets)!=null?L:0,percentage:(R=t==null?void 0:t.percentage_change_completed)!=null?R:0,img:ae,trend:(t==null?void 0:t.percentage_change_completed)>0?"up":(t==null?void 0:t.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(j=t==null?void 0:t.pending_tickets)!=null?j:0,percentage:(r=t==null?void 0:t.percentage_change_pending)!=null?r:0,img:re,trend:(t==null?void 0:t.percentage_change_pending)>0?"up":(t==null?void 0:t.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(A=t==null?void 0:t.inprogress_tickets)!=null?A:0,percentage:(g=t==null?void 0:t.percentage_change_inprogress)!=null?g:0,img:le,trend:(t==null?void 0:t.percentage_change_inprogress)>0?"up":(t==null?void 0:t.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(I=t==null?void 0:t.reopen_tickets)!=null?I:0,percentage:(p=t==null?void 0:t.percentage_change_reopen)!=null?p:0,img:ce,trend:(t==null?void 0:t.percentage_change_reopen)>0?"up":(t==null?void 0:t.percentage_change_reopen)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(s=t==null?void 0:t.closed_tickets)!=null?s:0,percentage:(D=t==null?void 0:t.percentage_change_closed)!=null?D:0,img:ie,trend:(t==null?void 0:t.percentage_change_closed)>0?"up":(t==null?void 0:t.percentage_change_closed)<0?"down":"neutral"}],u={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7};return e("div",{children:e(se,{ticketData:h,handleCardClick:l=>{const o=u[l];o&&E(`/rolestats/${o}`)}})})}X.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;const ye=()=>{const t=F(),[i,E]=c.exports.useState(!1),[m,B]=c.exports.useState([]),[h,u]=c.exports.useState(""),[V,M]=c.exports.useState("newest"),[S,L]=c.exports.useState([]);c.exports.useState(!1);const[R,j]=c.exports.useState(!1),[r,A]=c.exports.useState("1"),[g,I]=c.exports.useState(!1),p=n=>{r!==n&&(A(n),I(!0))},s=async()=>{try{const n=localStorage.getItem("authToken"),d=localStorage.getItem("user_id");if(!n){t("/login"),console.error("No token found, please login.");return}let z="https://bapi.reownlogics.com/api/help-desk",P={department_manager_id:d};const $={2:7,3:4,4:3,5:2,7:6};r==="6"?(z="https://bapi.reownlogics.com/api/help-desk",P={manager_status_id:3,department_manager_id:d,employee_status_id:6}):$[r]&&(P={manager_status_id:$[r],department_manager_id:d});const G=await H.get(z,{params:P,headers:{Authorization:`Bearer ${n}`}});console.log("Fetching tickets with:",$[r],d);let U=G.data;U.sort((J,Q)=>new Date(Q.created_at)-new Date(J.created_at)),L(U.slice(0,5)),console.log("employee data data",G.data)}catch(n){console.error("Error fetching employee data: ",n)}finally{j(!1),I(!1)}};c.exports.useEffect(()=>{s()},[r]),c.exports.useEffect(()=>{j(!0),s()},[]);const D=(n,d)=>V==="newest"?new Date(d.createdAt)-new Date(n.createdAt):V==="oldest"?new Date(n.createdAt)-new Date(d.createdAt):0,l=S.filter(n=>n.title.toLowerCase().includes(h.toLowerCase())).sort(D),o=()=>{E(!i),B(i?[]:S.map(n=>n.id))},f=n=>{B(d=>d.includes(n)?d.filter(z=>z!==n):[...d,n])},[O,K]=c.exports.useState(!1),q=()=>{K(!O)};if(R)return a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[e(v,{}),e("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]});const T=()=>{t(`/allmanagertickets?tab=${r}`)};return a("div",{children:[e(oe,{}),e("div",{className:"d-flex justify-content-end align-items-center",children:e(te,{isOpen:O,toggle:q,refreshTickets:s})}),e(de,{}),a(Y,{tabs:!0,className:"my-3",children:[e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="1",onClick:()=>{p("1")},children:"New"})}),e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="5",onClick:()=>{p("5")},children:"Unassigned"})}),e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="4",onClick:()=>{p("4")},children:"Assigned / Unresolved"})}),e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="7",onClick:()=>{p("7")},children:"Reopened"})}),e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="6",onClick:()=>{p("6")},children:"Reassigned"})}),e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="3",onClick:()=>{p("3")},children:"Resolved"})}),e(k,{className:"navbarItem",children:e(y,{className:"navbarLink",active:r==="2",onClick:()=>{p("2")},children:"Rejected"})})]}),e(Z,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:a(ee,{activeTab:r,children:[a(b,{tabId:"1",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"New Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:T,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]}),a(b,{tabId:"2",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Rejected Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:T,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]}),a(b,{tabId:"3",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Resolved Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:T,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]}),a(b,{tabId:"4",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Assigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:T,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]}),a(b,{tabId:"5",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Unassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:T,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]}),a(b,{tabId:"6",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e(W,{to:"/alltickets",style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]}),a(b,{tabId:"7",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reopened Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(_,{style:{borderRight:0},children:e(x,{size:16})}),e(w,{placeholder:"Search here ....",value:h,onChange:n=>u(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:T,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(C,{filteredEmployees:l,selectAll:i,selectedRows:m,handleSelectRow:f,handleSelectAll:o,refreshTickets:s})]})]})})]})};export{ye as default};
