import{r,K as J,j as e,M as Q,v as a,L as Z}from"./index.e4a29e23.js";import{s as ee,S as k,N as te,i as b,j as _,C as ne,k as ae,l as N,I as x,f as w,g as C,h as T}from"./App.07cedc2c.js";import{C as le}from"./createhelpdesk.cccaa3c7.js";import{c as re,C as se,a as ce,b as ie,d as oe,e as de,T as S}from"./tickettable.ea6c221b.js";import{C as he}from"./c6.4d79638f.js";import"./moment.ef14f9cc.js";import"./CardTitle.6bcfdb4b.js";function ge(){var P,R,z,E,L,v,l,V,g,j,p,s;const[t,c]=r.exports.useState(null),D=J(),u=async()=>{try{const i=localStorage.getItem("authToken"),o=localStorage.getItem("user_id");if(!i){window.location.href="/login",console.error("No token found, please login.");return}const m=await Q.get(`https://bapi.reownlogics.com/api/employee_dashboard/${o}`,{headers:{Authorization:`Bearer ${i}`}});c(m.data||{}),console.log("stats",m.data)}catch(i){console.error("Error fetching ticket stats:",i),c({})}};if(r.exports.useEffect(()=>{u()},[]),t===null)return e("div",{className:"d-flex justify-content-center align-items-center gap-2 mb-2",children:"Loading Stats..."});if(!Object.values(t).some(i=>typeof i=="number"&&i>0))return e("div",{className:"text-center p-4",children:"No stats available"});const h=[{key:"total_tickets",label:"Total Tickets",value:(P=t==null?void 0:t.total_tickets)!=null?P:0,percentage:(R=t==null?void 0:t.percentage_change_total)!=null?R:0,img:re,trend:(t==null?void 0:t.percentage_change_total)>0?"up":(t==null?void 0:t.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(z=t==null?void 0:t.completed_tickets)!=null?z:0,percentage:(E=t==null?void 0:t.percentage_change_completed)!=null?E:0,img:se,trend:(t==null?void 0:t.percentage_change_completed)>0?"up":(t==null?void 0:t.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(L=t==null?void 0:t.pending_tickets)!=null?L:0,percentage:(v=t==null?void 0:t.percentage_change_pending)!=null?v:0,img:ce,trend:(t==null?void 0:t.percentage_change_pending)>0?"up":(t==null?void 0:t.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(l=t==null?void 0:t.inprogress_tickets)!=null?l:0,percentage:(V=t==null?void 0:t.percentage_change_inprogress)!=null?V:0,img:ie,trend:(t==null?void 0:t.percentage_change_inprogress)>0?"up":(t==null?void 0:t.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(g=t==null?void 0:t.reopen_tickets)!=null?g:0,percentage:(j=t==null?void 0:t.percentage_change_reopen)!=null?j:0,img:oe,trend:(t==null?void 0:t.percentage_change_reopen)>0?"up":(t==null?void 0:t.percentage_change_reopen)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(p=t==null?void 0:t.closed_tickets)!=null?p:0,percentage:(s=t==null?void 0:t.percentage_change_closed)!=null?s:0,img:he,trend:(t==null?void 0:t.percentage_change_closed)>0?"up":(t==null?void 0:t.percentage_change_closed)<0?"down":"neutral"}],f={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7};return e("div",{children:e(de,{ticketData:h,handleCardClick:i=>{const o=f[i];i==="In Progress Tickets"?D("/in-progress-tickets"):o&&D(`/tickets/${o}`)}})})}const G=ee.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,be=()=>{const t=J(),[c,D]=r.exports.useState(!1),[u,M]=r.exports.useState([]),[h,f]=r.exports.useState(""),[B,P]=r.exports.useState("newest"),[R,z]=r.exports.useState([]);r.exports.useState(!1);const[E,L]=r.exports.useState(!1),v=localStorage.getItem("user_role"),[l,V]=r.exports.useState("1"),[g,j]=r.exports.useState(!1),p=n=>{l!==n&&(V(n),j(!0))},s=async()=>{try{l!=="1"&&j(!0);const n=localStorage.getItem("authToken"),d=localStorage.getItem("user_id");if(!n){t("/login"),console.error("No token found, please login.");return}let A="https://bapi.reownlogics.com/api/help-desk",$={employee_id:d};const O={2:7,3:4,4:3,5:2,7:6};l==="6"?(A="https://bapi.reownlogics.com/api/help-desk",$={employee_status_id:6,employee_id:d,manager_status_id:3}):l==="4"?(A=`https://bapi.reownlogics.com/api/help-desk?manager_status_id=3&employee_id=${d}`,$={}):O[l]&&($={employee_status_id:O[l],employee_id:d});const K=await Q.get(A,{params:$,headers:{Authorization:`Bearer ${n}`}});console.log("status tab",O[l]),console.log("Fetched employee data of tabs: ",K.data);let q=K.data;q.sort((X,Y)=>new Date(Y.created_at)-new Date(X.created_at)),z(q.slice(0,5))}catch(n){console.error("Error fetching employee data: ",n)}finally{L(!1),j(!1)}};r.exports.useEffect(()=>{s()},[l]),r.exports.useEffect(()=>{L(!0),s()},[]);const i=(n,d)=>B==="newest"?new Date(d.createdAt)-new Date(n.createdAt):B==="oldest"?new Date(n.createdAt)-new Date(d.createdAt):0,o=R.filter(n=>n.title.toLowerCase().includes(h.toLowerCase())).sort(i),m=()=>{D(!c),M(c?[]:R.map(n=>n.id))},y=n=>{M(d=>d.includes(n)?d.filter(A=>A!==n):[...d,n])},[U,W]=r.exports.useState(!1),F=()=>{W(!U)},H=()=>{const n=localStorage.getItem("user_id");v==="assistant"?t(`/assistant_dashboard/${n}`):(v==="manager"||v==="hr")&&t(`/manager_dashboard/${n}`)};if(E)return a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[e(k,{}),e("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]});const I=()=>{t(`/alltickets?tab=${l}`)};return a("div",{children:[a("div",{className:"d-flex justify-content-end align-items-center mb-2",children:[v==="assistant"&&e(G,{onClick:H,children:"Assigned Tickets"}),(v==="manager"||v==="hr")&&e(G,{onClick:H,children:"Managed Tickets"}),e(G,{onClick:F,className:"ms-1",children:"+ Create New"}),e(le,{isOpen:U,toggle:F,refreshTickets:s})]}),e(ge,{}),a(te,{tabs:!0,className:"my-3",children:[e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="1",onClick:()=>{p("1")},children:"New"})}),e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="2",onClick:()=>{p("2")},children:"Rejected"})}),e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="3",onClick:()=>{p("3")},children:"Resolved"})}),e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="4",onClick:()=>{p("4")},children:"Assigned / Unresolved"})}),e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="5",onClick:()=>{p("5")},children:"Unassigned"})}),e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="6",onClick:()=>{p("6")},children:"Reassigned"})}),e(b,{className:"navbarItem",children:e(_,{className:"navbarLink",active:l==="7",onClick:()=>{p("7")},children:"Reopened"})})]}),e(ne,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:a(ae,{activeTab:l,children:[a(N,{tabId:"1",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"New Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]}),a(N,{tabId:"2",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Rejected Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]}),a(N,{tabId:"3",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Resolved Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]}),a(N,{tabId:"4",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Assigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]}),a(N,{tabId:"5",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Unassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]}),a(N,{tabId:"6",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e(Z,{to:"/alltickets",style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]}),a(N,{tabId:"7",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reopened Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(x,{className:"mr-3",children:[e(w,{style:{borderRight:0},children:e(C,{size:16})}),e(T,{placeholder:"Search here ....",value:h,onChange:n=>f(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),g?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(k,{})}):e(S,{filteredEmployees:o,selectAll:c,selectedRows:u,handleSelectRow:y,handleSelectAll:m,refreshTickets:s})]})]})})]})};export{be as default};
