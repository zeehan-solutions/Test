import{r as o,a6 as D,j as r,v as a,K as S,L as A}from"./index.f9ed2f7a.js";import{R as M,c as j,C as N,b as I,s as Y,I as E,f as z,S as L,g as $,T as B,U as P,Q as U,V as q,W as O,Y as G}from"./App.b83c219c.js";import{C as H,h as x}from"./createhelpdesk.bdd44691.js";import{C as V,a as K}from"./CardTitle.e76ab14d.js";import{c as Q,C as W,a as F,b as J,d as X,e as Z,I as ee,f as re}from"./c6.1b3119e6.js";function te(){var i,_,k,f,d,w,p,g,t,l,h,u;const[e,s]=o.exports.useState(null),y=D(),m=async()=>{try{const n=localStorage.getItem("authToken"),c=localStorage.getItem("user_id");if(!n){window.location.href="/login",console.error("No token found, please login.");return}const R=await S.get(`https://bapi.reownlogics.com/api/employee_dashboard/${c}`,{headers:{Authorization:`Bearer ${n}`}});s(R.data)}catch(n){console.error("Error fetching ticket stats:",n),s(null)}};if(o.exports.useEffect(()=>{m()},[]),!e)return r("div",{className:"text-center p-2",children:"Loading stats..."});const T=[{key:"total_tickets",label:"Total Tickets",value:(i=e==null?void 0:e.total_tickets)!=null?i:0,percentage:(_=e==null?void 0:e.percentage_change_total)!=null?_:0,img:Q,trend:(e==null?void 0:e.percentage_change_total)>0?"up":(e==null?void 0:e.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(k=e==null?void 0:e.completed_tickets)!=null?k:0,percentage:(f=e==null?void 0:e.percentage_change_completed)!=null?f:0,img:W,trend:(e==null?void 0:e.percentage_change_completed)>0?"up":(e==null?void 0:e.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(d=e==null?void 0:e.pending_tickets)!=null?d:0,percentage:(w=e==null?void 0:e.percentage_change_pending)!=null?w:0,img:F,trend:(e==null?void 0:e.percentage_change_pending)>0?"up":(e==null?void 0:e.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(p=e==null?void 0:e.inprogress_tickets)!=null?p:0,percentage:(g=e==null?void 0:e.percentage_change_inprogress)!=null?g:0,img:J,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(t=e==null?void 0:e.inprogress_tickets)!=null?t:0,percentage:(l=e==null?void 0:e.percentage_change_inprogress)!=null?l:0,img:X,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(h=e==null?void 0:e.inprogress_tickets)!=null?h:0,percentage:(u=e==null?void 0:e.percentage_change_inprogress)!=null?u:0,img:Z,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"}],C={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7},b=n=>{const c=C[n];c&&y(`/tickets/${c}`)};return r("div",{children:r(M,{children:T.map((n,c)=>r(j,{sm:"6",md:"4",children:r(N,{className:"ticket-card bg-white",onClick:()=>b(n.label),style:{borderRadius:"30px"},children:a(I,{children:[a("div",{className:"d-flex justify-content-between",children:[a(V,{tag:"h6",className:"text-muted pe-auto",children:[n.label,r("h3",{className:"mt-2",children:n.value})]}),n.img&&r("img",{src:n.img,alt:"Icon",style:{width:60,height:60,marginLeft:"10px"}})]}),a("div",{className:"d-flex align-items-center",children:[n.trend==="up"&&r(ee,{size:16,style:{color:"green"}}),n.trend==="down"&&r(re,{size:16,style:{color:"red"}}),a("span",{className:"text-primary ms-1",children:[n.percentage,"%"]}),n.trend!=="neutral"&&r(K,{className:"text-muted ms-1",children:n.trend==="up"?"Up from yesterday":"Down from yesterday"})]})]})})},c))})})}const v=Y.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,le=()=>{const e=D();o.exports.useState(!1),o.exports.useState([]);const[s,y]=o.exports.useState(""),[m,T]=o.exports.useState("newest"),[C,b]=o.exports.useState([]);o.exports.useState(!1);const i=localStorage.getItem("user_role"),_=async()=>{try{const t=localStorage.getItem("authToken"),l=localStorage.getItem("user_id");if(!t){e("/login"),console.error("No token found, please login.");return}const h=await S.get("https://bapi.reownlogics.com/api/help-desk",{params:{employee_id:l},headers:{Authorization:`Bearer ${t}`}});let u=h.data;u.sort((n,c)=>new Date(c.created_at)-new Date(n.created_at)),b(u.slice(0,5)),console.log("employee data data",h.data)}catch(t){console.error("Error fetching employee data: ",t)}};o.exports.useEffect(()=>{_()});const k=(t,l)=>m==="newest"?new Date(l.createdAt)-new Date(t.createdAt):m==="oldest"?new Date(t.createdAt)-new Date(l.createdAt):0,f=C.filter(t=>t.title.toLowerCase().includes(s.toLowerCase())).sort(k),[d,w]=o.exports.useState(!1),p=()=>{w(!d)},g=()=>{const t=localStorage.getItem("user_id");i==="assistant"?e(`/assistant_dashboard/${t}`):i==="manager"&&e(`/manager_dashboard/${t}`)};return a("div",{children:[a("div",{className:"d-flex justify-content-end align-items-center mb-2",children:[i==="assistant"&&r(v,{onClick:g,children:"Assigned Tickets"}),i==="manager"&&r(v,{onClick:g,children:"Managed Tickets"}),r(v,{onClick:p,children:"+ Create New"}),r(H,{isOpen:d,toggle:p})]}),r(te,{}),a(N,{className:"bg-white ticket-card",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[r("div",{children:r("h3",{children:"Recent Ticket"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(E,{className:"mr-3",children:[r(z,{children:r(L,{size:16})}),r($,{placeholder:"Search by name",value:s,onChange:t=>y(t.target.value)})]}),r(A,{to:"/alltickets",style:{width:"50%"},className:"ms-1",children:"View All"})]})]}),r(I,{children:a(B,{striped:!0,responsive:!0,children:[r("thead",{children:a("tr",{children:[r("th",{children:"Name"}),r("th",{children:"Requested Date"}),r("th",{children:"Requested Time"}),r("th",{children:"Rating"}),r("th",{children:"Time for Requested to Resolution"}),r("th",{children:"Actions"})]})}),r("tbody",{children:f.map(t=>a("tr",{children:[r("td",{children:t.title}),r("td",{children:x(t.created_at).format("YYYY-MM-DD")}),r("td",{children:x(t.created_at).format("hh:mm:ss A")}),r("td",{children:t.title}),r("td",{children:r("span",{style:{background:"#daf1df",padding:"6px",borderRadius:"100px"},children:x(t.created_at).format("YYYY-MM-DD hh:mm:ss A")})}),r("td",{children:a(P,{children:[r(U,{className:"pe-1",tag:"span",children:r(q,{size:15})}),r(O,{end:!0,children:r(G,{onClick:()=>e(`/ticket-detail/${t.id}`),children:r("span",{className:"align-middle ms-50",children:"Detail"})})})]})})]},t.id))})]})})]})]})};export{le as default};
