import{p as n,t as J,a9 as F,m as z,a as G,j as t,r as d,v as l,M as R}from"./index.0e991307.js";import{s as W,M as U,k as Y,l as K,L as _,h as I,m as q}from"./App.f2f7ddbf.js";import{F as D}from"./FormGroup.86db02e3.js";import{f as $,A as H}from"./format.41035fce.js";var Q=["children","className","barClassName","cssModule","value","min","max","animated","striped","color","bar","multi","tag","style","barStyle","barAriaValueText","barAriaLabelledBy"];function V(e,o){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);o&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function E(e){for(var o=1;o<arguments.length;o++){var a=arguments[o]!=null?arguments[o]:{};o%2?V(Object(a),!0).forEach(function(r){X(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function X(e,o,a){return o in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a,e}function Z(e,o){if(e==null)return{};var a=ee(e,o),r,i;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(i=0;i<u.length;i++)r=u[i],!(o.indexOf(r)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,r)||(a[r]=e[r]))}return a}function ee(e,o){if(e==null)return{};var a={},r=Object.keys(e),i,u;for(u=0;u<r.length;u++)i=r[u],!(o.indexOf(i)>=0)&&(a[i]=e[i]);return a}var te={animated:n.exports.bool,bar:n.exports.bool,barAriaLabelledBy:n.exports.string,barAriaValueText:n.exports.string,barClassName:n.exports.string,barStyle:n.exports.object,children:n.exports.node,className:n.exports.string,cssModule:n.exports.object,color:n.exports.string,max:n.exports.oneOfType([n.exports.string,n.exports.number]),min:n.exports.oneOfType([n.exports.string,n.exports.number]),multi:n.exports.bool,striped:n.exports.bool,style:n.exports.object,tag:J,value:n.exports.oneOfType([n.exports.string,n.exports.number])};function ae(e){var o=e.children,a=e.className,r=e.barClassName,i=e.cssModule,u=e.value,s=u===void 0?0:u,v=e.min,p=v===void 0?0:v,k=e.max,O=k===void 0?100:k,S=e.animated,C=e.striped,f=e.color,x=e.bar,T=e.multi,g=e.tag,y=g===void 0?"div":g,M=e.style,P=M===void 0?{}:M,j=e.barStyle,A=j===void 0?{}:j,w=e.barAriaValueText,m=e.barAriaLabelledBy,c=Z(e,Q),h=F(s)/F(O)*100,b=z(G(a,"progress"),i),L=z(G("progress-bar",x&&a||r,S?"progress-bar-animated":null,f?"bg-".concat(f):null,C||S?"progress-bar-striped":null),i),N={className:L,style:E(E(E({},x?P:{}),A),{},{width:"".concat(h,"%")}),role:"progressbar","aria-valuenow":s,"aria-valuemin":p,"aria-valuemax":O,"aria-valuetext":w,"aria-labelledby":m,children:o};return x?t(y,{...c,...N}):t(y,{...c,style:P,className:b,children:T?o:t("div",{...N})})}ae.propTypes=te;const oe="https://bapi.reownlogics.com/api/employee/check-out",ce=({employeeId:e,setCheckOutModal:o,checkOutModal:a,time:r,fetchEmployeeAttendence:i,fetchCurrentDaySummary:u})=>{const[s,v]=d.exports.useState({lat:null,lng:null}),[p,k]=d.exports.useState(!1),[O,S]=d.exports.useState(""),[C,f]=d.exports.useState(""),[x,T]=d.exports.useState(""),[g,y]=d.exports.useState(null),[M,P]=d.exports.useState($(new Date,"hh:mm a"));d.exports.useEffect(()=>{const m=setInterval(()=>{P($(new Date,"hh:mm a"))},1e3);return()=>clearInterval(m)},[]);const j=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(m=>{v({lat:m.coords.latitude,lng:m.coords.longitude})},m=>{alert("Unable to retrieve location. Please enable GPS.")}):alert("Geolocation is not supported by this browser.")},A=async()=>{var L,N;if(!g){f("Select an Option First");return}if(!s.lat||!s.lng){alert("Please get your location first.");return}const m=new Date,c=m.getTimezoneOffset()*6e4,h=new Date(m-c).toISOString().slice(0,19).replace("T"," "),b={site:g,out_lat:s.lat||0,out_lng:s.lng||0,check_out:h,employee_id:e};k(!0),S("");try{const B=localStorage.getItem("authToken"),re=await R.post(oe,b,{headers:{Authorization:`Bearer ${B}`,Accept:"application/json"}});await i(),await u(),T("Check Out Successfully"),setTimeout(()=>{o(!1),T("")},2e3),v({lat:"",lng:""}),y(null)}catch(B){S(((N=(L=B.response)==null?void 0:L.data)==null?void 0:N.message)||"Failed to check out. Please try again.")}finally{k(!1)}},w=W.button`
    background-color: #0C1539 !important;
    width: 155px;
    height: 40px;
    border-radius: 10px !important;
    color: white;
    cursor: pointer;
    border: none;
    &:hover {
      background-color: #1a2447 !important;
    }
      &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  `;return t("div",{className:"vertically-centered-modal",children:l(U,{isOpen:a,toggle:()=>o(!a),className:"modal-dialog-centered",children:[l(Y,{style:{padding:"17px 30px 0 30px",width:"100%",margin:"0 auto"},children:[t("p",{className:"fw-medium",style:{fontSize:"18px",color:"black"},children:"Check Out Time"}),l("div",{className:"text-start",children:[l("p",{children:["Your Check Out time is ",r]}),l(K,{className:"w-sm-50 text-start",children:[t(D,{className:"mt-1",check:!0,children:l(_,{check:!0,children:[t(I,{type:"checkbox",name:"site",value:"on-site",checked:g==="on-site",onChange:()=>{y("on-site"),f("")}}),"On Site"]})}),t(D,{className:"pb-1",check:!0,children:l(_,{check:!0,children:[t(I,{type:"checkbox",name:"site",value:"out-of-radius",checked:g==="out-of-radius",onChange:()=>{y("out-of-radius"),f("")}}),"Out of Radius"]})}),s.lat&&s.lng&&l("p",{className:" fs-5",children:["latitude: ",t("span",{className:"pe-1",children:s.lat})," longitude:",t("span",{children:s.lng})," "]}),O&&t("p",{className:"text-danger",children:O}),C&&t("p",{className:"text-danger",children:C}),x&&t(H,{color:"success",className:"mt-2 p-1",children:x})]})]})]}),t(q,{className:" text-center pt-2",children:l("div",{className:"d-flex justify-content-between w-100",children:[t(w,{onClick:j,children:"Get My Location"}),t(w,{onClick:A,disabled:p||!s.lat||!s.lng,children:p?"Checking Out...":"Check Out"})]})})]})})};const de=({employeeId:e,checkInModal:o,setCheckInModal:a,time:r,fetchCurrentDaySummary:i,fetchEmployeeAttendence:u})=>{const[s,v]=d.exports.useState({option1:!1,option2:!1,option3:!1}),[p,k]=d.exports.useState({latitude:null,longitude:null}),[O,S]=d.exports.useState(!1),[C,f]=d.exports.useState(""),[x,T]=d.exports.useState(""),[g,y]=d.exports.useState(""),[M,P]=d.exports.useState($(new Date,"hh:mm a"));d.exports.useEffect(()=>{const c=setInterval(()=>{P($(new Date,"hh:mm a"))},1e3);return()=>clearInterval(c)},[]);const j=()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(c=>{const{latitude:h,longitude:b}=c.coords;k({latitude:h,longitude:b})},c=>{console.error("Error getting location:",c)}):console.error("Geolocation is not supported by this browser.")},A=async()=>{const c=s.option1?"on-site":s.option2?"out-of-radius":s.option3?"vacation":"";if(!c){f("Select an Option First");return}S(!0);try{const h=localStorage.getItem("authToken"),b=new Date,L=b.getTimezoneOffset()*6e4,N=new Date(b-L).toISOString().slice(0,19).replace("T"," "),B=await R.post("https://bapi.reownlogics.com/api/employee/check-in",{site:c,lat:p.latitude||0,lng:p.longitude||0,comment:x,check_in:N,employee_id:e},{headers:{Authorization:`Bearer ${h}`,Accept:"application/json"}});await i(),await u(),y("Check In Successfully"),setTimeout(()=>{a(!1),y("")},2e3),v({option1:!1,option2:!1,option3:!1}),k({latitude:"",longitude:""})}catch(h){console.error("Error checking in:",h),alert("Failed to check-in. Please try again.")}finally{S(!1)}},w=c=>{const{name:h,checked:b}=c.target;v({option1:!1,option2:!1,option3:!1,[h]:b}),f("")},m=W.button`
    background-color: #0c1539 !important;
    width: 155px;
    height: 40px;
    border-radius: 10px !important;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
    border: none;

    &:hover {
      background-color: #1a2447 !important;
    }
      &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  `;return t("div",{className:"vertically-centered-modal",children:l(U,{isOpen:o,toggle:()=>a(!o),className:"modal-dialog-centered",children:[l(Y,{style:{padding:"17px 30px"},children:[t("p",{className:"pb-1 mb-0 fw-medium",style:{fontSize:"18px",color:"black"},children:"Check In Time"}),l("div",{className:"text-start",children:[l("p",{children:["Your Check-in time is ",r]}),t("p",{children:"Where are you today?"}),l(K,{children:[t(D,{check:!0,children:l(_,{check:!0,children:[t(I,{type:"checkbox",name:"option1",checked:s.option1,onChange:w}),"On Site"]})}),t(D,{check:!0,children:l(_,{check:!0,children:[t(I,{type:"checkbox",name:"option2",checked:s.option2,onChange:w}),"Out of Radius"]})}),s.option2&&l("div",{style:{marginBottom:"5px"},children:[t(_,{for:"locationDetails",children:"Reason"}),t(I,{type:"textarea",onChange:c=>T(c.target.value),value:x,val:!0,name:"locationDetails",id:"locationDetails"})]}),t(D,{check:!0,children:l(_,{check:!0,children:[t(I,{type:"checkbox",name:"option3",checked:s.option3,onChange:w}),"On Vacation"]})})]}),p.latitude&&p.longitude&&t("div",{className:"mt-1 text-start",children:l("p",{className:"mb-0",children:["Latitude: ",t("span",{className:"pe-1",children:p.latitude}),"  Longitude: ",t("span",{children:p.longitude})]})}),C&&t("p",{className:"text-danger mb-0 text-center",children:C}),g&&t(H,{color:"success",className:"mt-2 p-1",children:g})]})]}),t(q,{className:"border-none text-center pt-2",children:l("div",{className:"d-flex w-100 justify-content-between",children:[t(m,{onClick:j,children:"Get My Location"}),t(m,{onClick:A,disabled:O||!p.latitude||!p.longitude,children:O?"Checking In...":"Check In"})]})})]})})};export{ce as C,ae as P,de as a};
