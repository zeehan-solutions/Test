import{r as o,a6 as v,j as r,v as a,K as T,L as I}from"./index.70eb4055.js";import{R,c as A,C as D,b as N,s as j,I as M,f as E,S as z,g as L,T as $,P as B,Q as P,V as Y,W as O,Y as U}from"./App.a52e237f.js";import{h as G}from"./moment.68d8b8f0.js";import{C as H}from"./createhelpdesk.276add72.js";import{C as V,a as q}from"./CardTitle.de1fe7a3.js";import{c as K,C as Q,a as W,b as F,I as J,d as X}from"./c5.e6526898.js";import{C as Z,a as ee}from"./c6.340874ed.js";function re(){var h,m,u,d,_,b,n,c,s,p,k,f;const[e,i]=o.exports.useState(null),w=v(),g=async()=>{try{const t=localStorage.getItem("authToken"),l=localStorage.getItem("user_id");if(!t){window.location.href="/login",console.error("No token found, please login.");return}const S=await T.get(`https://bapi.reownlogics.com/api/manager_dashboard/${l}`,{headers:{Authorization:`Bearer ${t}`}});i(S.data)}catch(t){console.error("Error fetching ticket stats:",t),i(null)}};if(o.exports.useEffect(()=>{g()},[]),!e)return r("div",{className:"text-center p-2",children:"Loading stats..."});const C=[{key:"total_tickets",label:"Total Tickets",value:(h=e==null?void 0:e.total_tickets)!=null?h:0,percentage:(m=e==null?void 0:e.percentage_change_total)!=null?m:0,img:K,trend:(e==null?void 0:e.percentage_change_total)>0?"up":(e==null?void 0:e.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(u=e==null?void 0:e.completed_tickets)!=null?u:0,percentage:(d=e==null?void 0:e.percentage_change_completed)!=null?d:0,img:Q,trend:(e==null?void 0:e.percentage_change_completed)>0?"up":(e==null?void 0:e.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(_=e==null?void 0:e.pending_tickets)!=null?_:0,percentage:(b=e==null?void 0:e.percentage_change_pending)!=null?b:0,img:W,trend:(e==null?void 0:e.percentage_change_pending)>0?"up":(e==null?void 0:e.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(n=e==null?void 0:e.inprogress_tickets)!=null?n:0,percentage:(c=e==null?void 0:e.percentage_change_inprogress)!=null?c:0,img:Z,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(s=e==null?void 0:e.reopen_tickets)!=null?s:0,percentage:(p=e==null?void 0:e.percentage_change_reopen)!=null?p:0,img:F,trend:(e==null?void 0:e.percentage_change_reopen)>0?"up":(e==null?void 0:e.percentage_change_reopen)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(k=e==null?void 0:e.closed_tickets)!=null?k:0,percentage:(f=e==null?void 0:e.percentage_change_closed)!=null?f:0,img:ee,trend:(e==null?void 0:e.percentage_change_closed)>0?"up":(e==null?void 0:e.percentage_change_closed)<0?"down":"neutral"}],y={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7},x=t=>{const l=y[t];l&&w(`/tickets/${l}`)};return r("div",{children:r(R,{children:C.map((t,l)=>r(A,{sm:"6",md:"4",children:r(D,{className:"ticket-card bg-white",onClick:()=>x(t.label),style:{borderRadius:"30px"},children:a(N,{children:[a("div",{className:"d-flex justify-content-between",children:[a(V,{tag:"h6",className:"text-muted pe-auto",children:[t.label,r("h3",{className:"mt-2",children:t.value})]}),t.img&&r("img",{src:t.img,alt:"Icon",style:{width:60,height:60,marginLeft:"10px"}})]}),a("div",{className:"d-flex align-items-center",children:[t.trend==="up"&&r(J,{size:16,style:{color:"green"}}),t.trend==="down"&&r(X,{size:16,style:{color:"red"}}),a("span",{className:"text-primary ms-1",children:[t.percentage,"%"]}),t.trend!=="neutral"&&r(q,{className:"text-muted ms-1",children:t.trend==="up"?"Up from yesterday":"Down from yesterday"})]})]})})},l))})})}j.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;const de=()=>{const e=v();o.exports.useState(!1),o.exports.useState([]);const[i,w]=o.exports.useState(""),[g,C]=o.exports.useState("newest"),[y,x]=o.exports.useState([]);o.exports.useState(!1);const h=async()=>{try{const n=localStorage.getItem("authToken"),c=localStorage.getItem("user_id");if(!n){e("/login"),console.error("No token found, please login.");return}const s=await T.get(`https://bapi.reownlogics.com/api/help-desk?department_manager_id=${c}`,{headers:{Authorization:`Bearer ${n}`}});let p=s.data;p.sort((k,f)=>new Date(f.created_at)-new Date(k.created_at)),x(p.slice(0,5)),console.log("employee data data",s.data)}catch(n){console.error("Error fetching employee data: ",n)}};o.exports.useEffect(()=>{h()},[]);const m=(n,c)=>g==="newest"?new Date(c.createdAt)-new Date(n.createdAt):g==="oldest"?new Date(n.createdAt)-new Date(c.createdAt):0,u=y.filter(n=>n.title.toLowerCase().includes(i.toLowerCase())).sort(m),[d,_]=o.exports.useState(!1);return a("div",{children:[r("div",{className:"d-flex justify-content-end align-items-center mb-2",children:r(H,{isOpen:d,toggle:()=>{_(!d)}})}),r(re,{}),a(D,{className:"bg-white ticket-card",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[r("div",{children:r("h3",{children:"Recent Ticket"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(M,{className:"mr-3",children:[r(E,{children:r(z,{size:16})}),r(L,{placeholder:"Search by name",value:i,onChange:n=>w(n.target.value)})]}),r(I,{to:"/allmanagertickets",style:{width:"50%"},className:"ms-1",children:"View All"})]})]}),r(N,{children:a($,{striped:!0,responsive:!0,children:[r("thead",{children:a("tr",{children:[r("th",{children:"Name"}),r("th",{children:"Description"}),r("th",{children:"Department"}),r("th",{children:"Time for Requested to Resolution"}),r("th",{children:"Actions"})]})}),r("tbody",{children:u.map(n=>a("tr",{children:[r("td",{children:n.title}),r("td",{children:n.description}),r("td",{children:n.department.name}),r("td",{children:r("span",{style:{background:"#daf1df",padding:"6px",borderRadius:"100px"},children:G(n.created_at).format("YYYY-MM-DD hh:mm:ss A")})}),r("td",{children:a(B,{children:[r(P,{className:"pe-1",tag:"span",children:r(Y,{size:15})}),r(O,{end:!0,children:r(U,{onClick:()=>e(`/ticket-detail/${n.id}`),children:r("span",{className:"align-middle ms-50",children:"Detail"})})})]})})]},n.id))})]})})]})]})};export{de as default};
