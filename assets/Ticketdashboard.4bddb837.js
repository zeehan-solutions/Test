import{r,K as J,j as e,M as Q,v as a,L as Z}from"./index.6f6a8d80.js";import{s as ee,S as v,N as te,i as k,j as b,C as ne,k as ae,l as _,I as N,f as x,g as w,h as C}from"./App.c605b380.js";import{C as le}from"./createhelpdesk.7d4db264.js";import{c as re,C as ce,a as se,b as ie,d as oe,e as de,T as S}from"./tickettable.748f5ad0.js";import{C as he}from"./c6.4d79638f.js";import"./moment.ef14f9cc.js";import"./CardTitle.290b3685.js";function ge(){var P,R,z,E,L,u,l,V,h,j,g,T;const[t,c]=r.exports.useState(null),D=J(),p=async()=>{try{const s=localStorage.getItem("authToken"),i=localStorage.getItem("user_id");if(!s){window.location.href="/login",console.error("No token found, please login.");return}const f=await Q.get(`https://bapi.reownlogics.com/api/employee_dashboard/${i}`,{headers:{Authorization:`Bearer ${s}`}});c(f.data||{})}catch(s){console.error("Error fetching ticket stats:",s),c({})}};if(r.exports.useEffect(()=>{p()},[]),t===null)return e("div",{className:"d-flex justify-content-center align-items-center gap-2 mb-2",children:"Loading Stats..."});if(!Object.values(t).some(s=>typeof s=="number"&&s>0))return e("div",{className:"text-center p-4",children:"No stats available"});const d=[{key:"total_tickets",label:"Total Tickets",value:(P=t==null?void 0:t.total_tickets)!=null?P:0,percentage:(R=t==null?void 0:t.percentage_change_total)!=null?R:0,img:re,trend:(t==null?void 0:t.percentage_change_total)>0?"up":(t==null?void 0:t.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(z=t==null?void 0:t.completed_tickets)!=null?z:0,percentage:(E=t==null?void 0:t.percentage_change_completed)!=null?E:0,img:ce,trend:(t==null?void 0:t.percentage_change_completed)>0?"up":(t==null?void 0:t.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(L=t==null?void 0:t.pending_tickets)!=null?L:0,percentage:(u=t==null?void 0:t.percentage_change_pending)!=null?u:0,img:se,trend:(t==null?void 0:t.percentage_change_pending)>0?"up":(t==null?void 0:t.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(l=t==null?void 0:t.inprogress_tickets)!=null?l:0,percentage:(V=t==null?void 0:t.percentage_change_inprogress)!=null?V:0,img:ie,trend:(t==null?void 0:t.percentage_change_inprogress)>0?"up":(t==null?void 0:t.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(h=t==null?void 0:t.reopen_tickets)!=null?h:0,percentage:(j=t==null?void 0:t.percentage_change_reopen)!=null?j:0,img:oe,trend:(t==null?void 0:t.percentage_change_reopen)>0?"up":(t==null?void 0:t.percentage_change_reopen)<0?"down":"neutral"},{key:"Closed-Rejected",label:"Closed-Rejected",value:(g=t==null?void 0:t.closed_tickets)!=null?g:0,percentage:(T=t==null?void 0:t.percentage_change_closed)!=null?T:0,img:he,trend:(t==null?void 0:t.percentage_change_closed)>0?"up":(t==null?void 0:t.percentage_change_closed)<0?"down":"neutral"}],m={"Pending Tickets":2,"In Progress Tickets":3,"Completed Tickets":4,Reopen:6,"Closed-Rejected":7};return e("div",{children:e(de,{ticketData:d,handleCardClick:s=>{const i=m[s];s==="In Progress Tickets"?D("/in-progress-tickets"):i&&D(`/tickets/${i}`)}})})}const G=ee.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,be=()=>{const t=J(),[c,D]=r.exports.useState(!1),[p,M]=r.exports.useState([]),[d,m]=r.exports.useState(""),[B,P]=r.exports.useState("newest"),[R,z]=r.exports.useState([]);r.exports.useState(!1);const[E,L]=r.exports.useState(!1),u=localStorage.getItem("user_role"),[l,V]=r.exports.useState("1"),[h,j]=r.exports.useState(!1),g=n=>{l!==n&&(V(n),j(!0))},T=async()=>{try{l!=="1"&&j(!0);const n=localStorage.getItem("authToken"),o=localStorage.getItem("user_id");if(!n){t("/login"),console.error("No token found, please login.");return}let A="https://bapi.reownlogics.com/api/help-desk",$={employee_id:o};const O={2:7,3:4,4:3,5:2,7:6};l==="6"?(A="https://bapi.reownlogics.com/api/help-desk",$={employee_status_id:6,employee_id:o,manager_status_id:3}):l==="4"?(A=`https://bapi.reownlogics.com/api/help-desk?manager_status_id=3&employee_id=${o}`,$={}):O[l]&&($={employee_status_id:O[l],employee_id:o});const K=await Q.get(A,{params:$,headers:{Authorization:`Bearer ${n}`}});console.log("status tab",O[l]),console.log("Fetched employee data of tabs: ",K.data);let q=K.data;q.sort((X,Y)=>new Date(Y.created_at)-new Date(X.created_at)),z(q.slice(0,5))}catch(n){console.error("Error fetching employee data: ",n)}finally{L(!1),j(!1)}};r.exports.useEffect(()=>{T()},[l]),r.exports.useEffect(()=>{L(!0),T()},[]);const s=(n,o)=>B==="newest"?new Date(o.createdAt)-new Date(n.createdAt):B==="oldest"?new Date(n.createdAt)-new Date(o.createdAt):0,i=R.filter(n=>n.title.toLowerCase().includes(d.toLowerCase())).sort(s),f=()=>{D(!c),M(c?[]:R.map(n=>n.id))},y=n=>{M(o=>o.includes(n)?o.filter(A=>A!==n):[...o,n])},[U,W]=r.exports.useState(!1),F=()=>{W(!U)},H=()=>{const n=localStorage.getItem("user_id");u==="assistant"?t(`/assistant_dashboard/${n}`):(u==="manager"||u==="hr")&&t(`/manager_dashboard/${n}`)};if(E)return a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[e(v,{}),e("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]});const I=()=>{t(`/alltickets?tab=${l}`)};return a("div",{children:[a("div",{className:"d-flex justify-content-end align-items-center mb-2",children:[u==="assistant"&&e(G,{onClick:H,children:"Assigned Tickets"}),(u==="manager"||u==="hr")&&e(G,{onClick:H,children:"Managed Tickets"}),e(G,{onClick:F,className:"ms-1",children:"+ Create New"}),e(le,{isOpen:U,toggle:F,refreshTickets:T})]}),e(ge,{}),a(te,{tabs:!0,className:"my-3",children:[e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="1",onClick:()=>{g("1")},children:"New"})}),e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="2",onClick:()=>{g("2")},children:"Rejected"})}),e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="3",onClick:()=>{g("3")},children:"Resolved"})}),e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="4",onClick:()=>{g("4")},children:"Assigned / Unresolved"})}),e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="5",onClick:()=>{g("5")},children:"Unassigned"})}),e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="6",onClick:()=>{g("6")},children:"Reassigned"})}),e(k,{className:"navbarItem",children:e(b,{className:"navbarLink",active:l==="7",onClick:()=>{g("7")},children:"Reopened"})})]}),e(ne,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:a(ae,{activeTab:l,children:[a(_,{tabId:"1",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"New Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]}),a(_,{tabId:"2",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Rejected Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]}),a(_,{tabId:"3",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Resolved Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]}),a(_,{tabId:"4",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Assigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]}),a(_,{tabId:"5",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Unassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]}),a(_,{tabId:"6",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reassigned Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e(Z,{to:"/alltickets",style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]}),a(_,{tabId:"7",children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Reopened Tickets"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(N,{className:"mr-3",children:[e(x,{style:{borderRight:0},children:e(w,{size:16})}),e(C,{placeholder:"Search here ....",value:d,onChange:n=>m(n.target.value),style:{borderLeft:0}})]}),e("span",{onClick:I,style:{},className:"ms-1 viewall cursor-pointer",children:"View All"})]})]}),h?e("div",{className:"d-flex justify-content-center align-items-center fs-4",style:{height:"200px"},children:e(v,{})}):e(S,{filteredEmployees:i,selectAll:c,selectedRows:p,handleSelectRow:y,handleSelectAll:f})]})]})})]})};export{be as default};
