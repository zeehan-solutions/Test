import{r,a6 as O,v as n,j as e,B as C,K as z}from"./index.021d50c3.js";import{s as D,S as $,C as G,I as q,f as H,g as F,h as K,b as U,T as W,W as Z,Y as J,Z as Q,$ as V,a0 as X}from"./App.1f34475c.js";import{h as p}from"./moment.68d8b8f0.js";import{C as ee}from"./createhelpdesk.dfbfbc2f.js";const te=D.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important;
  }
`;D.button`
  background-color:rgb(231, 231, 231) !important;
  width: 300px;
  padding: 10px;
  color: black;
  border: none;
  cursor: pointer;
  transition: background-color 0.3s;
`;const ce=()=>{const[i,v]=r.exports.useState(!1),[A,u]=r.exports.useState([]),[g,N]=r.exports.useState(""),[m,M]=r.exports.useState([]),[f,ne]=r.exports.useState("newest");r.exports.useState(!1);const[a,E]=r.exports.useState(1),[c]=r.exports.useState(5),[T,x]=r.exports.useState(!1),d=O(),[w,B]=r.exports.useState(!1),k=()=>{B(!w)},l=localStorage.getItem("authToken"),Y=localStorage.getItem("user_id"),b=async()=>{x(!0);try{if(l){const t=await z.get(`https://bapi.reownlogics.com/api/help-desk?assigned_to_id=${Y}`,{headers:{Authorization:`Bearer ${l}`}});console.log("sortedemployees",t.data);const s=t.data.sort((o,L)=>new Date(L.created_at)-new Date(o.created_at));M(s)}else console.log("No token found. Please log in again."),d("/login")}catch(t){console.error("Error fetching employee data: ",t)}finally{x(!1)}};r.exports.useEffect(()=>{b()},[l,d]);const _=(t,s)=>f==="newest"?new Date(s.createdAt)-new Date(t.createdAt):f==="oldest"?new Date(t.createdAt)-new Date(s.createdAt):0,h=m.filter(t=>t.title.toLowerCase().includes(g.toLowerCase())).sort(_),S=a*c,j=S-c,I=h.slice(j,S),y=t=>E(t),R=()=>{v(!i),u(i?[]:m.map(t=>t.id))},P=t=>{u(s=>s.includes(t)?s.filter(o=>o!==t):[...s,t])};return T?n("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[e($,{}),e("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]}):n("div",{children:[n("div",{className:"d-flex justify-content-end align-items-center mb-2",children:[e(te,{onClick:k,children:"+ Create New"}),e(ee,{isOpen:w,toggle:k,refreshTickets:b})]}),n(G,{children:[n("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[e("div",{children:e("h3",{children:"Recent Ticket"})}),e("div",{className:"d-flex align-items-center justify-content-end",children:n(q,{className:"mr-3",children:[e(H,{children:e(F,{size:16})}),e(K,{placeholder:"Search by name",value:g,onChange:t=>N(t.target.value)})]})})]}),n(U,{children:[n(W,{striped:!0,responsive:!0,children:[e("thead",{children:n("tr",{children:[e("th",{children:e("input",{type:"checkbox",checked:i,onChange:R})}),e("th",{children:"Name"}),e("th",{children:"Requested Date"}),e("th",{children:"Requested Time"}),e("th",{children:"Assign By"}),e("th",{children:"Rating"}),e("th",{children:"Created At"}),e("th",{children:"Actions"})]})}),e("tbody",{children:I.map(t=>{var s,o;return n("tr",{children:[e("td",{children:e("input",{type:"checkbox",checked:A.includes(t.id),onChange:()=>P(t.id)})}),e("td",{children:t.title}),e("td",{children:p(t.created_at).format("YYYY-MM-DD")}),e("td",{children:p(t.created_at).format("hh:mm:ss A")}),e("td",{children:(o=(s=t.department)==null?void 0:s.manager)!=null&&o.name?t.department.manager.name:"N/A"}),e("td",{children:t.reviews.rating}),e("td",{children:e("span",{style:{background:"#daf1df",padding:"6px",borderRadius:"100px"},children:p(t.created_at).format("YYYY-MM-DD hh:mm:ss A")})}),e("td",{children:n(Z,{children:[e(J,{className:"pe-1",tag:"span",children:e(Q,{size:15})}),e(V,{end:!0,children:e(X,{onClick:()=>d(`/ticket-detail/${t.id}`),children:e("span",{className:"align-middle ms-50",children:"Detail"})})})]})})]},t.id)})})]}),n("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e(C,{disabled:a===1,onClick:()=>y(a-1),children:"Previous"}),n("div",{children:["Page ",a," of ",Math.ceil(h.length/c)]}),e(C,{disabled:a===Math.ceil(h.length/c),onClick:()=>y(a+1),children:"Next"})]})]})]})]})};export{ce as default};
