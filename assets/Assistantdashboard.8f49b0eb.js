import{r as c,K as C,j as t,v as a,M as S,L as I}from"./index.0e991307.js";import{R as B,c as R,C as T,b as N,s as z,S as $,I as j,f as A,g as L,h as M,T as E,Z as P,$ as O,a0 as Y,a1 as G,a2 as U}from"./App.f2f7ddbf.js";import{h as v}from"./ticketstable.c660ffcc.js";import{C as F}from"./createhelpdesk.23221a72.js";import{C as H,a as W}from"./CardTitle.7106e3ec.js";import{c as q,C as K,a as V,b as Z,d as J,I as Q,e as X}from"./c5.27a2ef20.js";import{B as ee}from"./Backbutton.e95fbde2.js";function te(){var d,p,m,f,h,k,_,r,s,g;const[e,l]=c.exports.useState(null),i=C(),u=async()=>{try{const n=localStorage.getItem("authToken"),o=localStorage.getItem("user_id");if(!n){window.location.href="/login",console.error("No token found, please login.");return}const b=await S.get(`https://bapi.reownlogics.com/api/assistant_dashboard/${o}`,{headers:{Authorization:`Bearer ${n}`}});l(b.data||{})}catch(n){console.error("Error fetching ticket stats:",n),l({})}};if(c.exports.useEffect(()=>{u()},[]),e===null)return t("div",{className:"text-center p-2",children:"Loading stats..."});if(!Object.values(e).some(n=>typeof n=="number"&&n>0))return t("div",{className:"text-center p-4",children:"No stats available"});const w=[{key:"total_tickets",label:"Total Tickets",value:(d=e==null?void 0:e.total_tickets)!=null?d:0,percentage:(p=e==null?void 0:e.percentage_change_total)!=null?p:0,img:q,trend:(e==null?void 0:e.percentage_change_total)>0?"up":(e==null?void 0:e.percentage_change_total)<0?"down":"neutral"},{key:"completed_tickets",label:"Completed Tickets",value:(m=e==null?void 0:e.completed_tickets)!=null?m:0,percentage:(f=e==null?void 0:e.percentage_change_completed)!=null?f:0,img:K,trend:(e==null?void 0:e.percentage_change_completed)>0?"up":(e==null?void 0:e.percentage_change_completed)<0?"down":"neutral"},{key:"pending_tickets",label:"Pending Tickets",value:(h=e==null?void 0:e.pending_tickets)!=null?h:0,percentage:(k=e==null?void 0:e.percentage_change_pending)!=null?k:0,img:V,trend:(e==null?void 0:e.percentage_change_pending)>0?"up":(e==null?void 0:e.percentage_change_pending)<0?"down":"neutral"},{key:"inprogress_tickets",label:"In Progress Tickets",value:(_=e==null?void 0:e.inprogress_tickets)!=null?_:0,percentage:(r=e==null?void 0:e.percentage_change_inprogress)!=null?r:0,img:Z,trend:(e==null?void 0:e.percentage_change_inprogress)>0?"up":(e==null?void 0:e.percentage_change_inprogress)<0?"down":"neutral"},{key:"Reopen",label:"Reopen",value:(s=e==null?void 0:e.reopen_tickets)!=null?s:0,percentage:(g=e==null?void 0:e.percentage_change_reopen)!=null?g:0,img:J,trend:(e==null?void 0:e.percentage_change_reopen)>0?"up":(e==null?void 0:e.percentage_change_reopen)<0?"down":"neutral"}],x={"Pending Tickets":2,"In Progress Tickets":"progress","Completed Tickets":"completed",Reopen:"reopen","Closed-Rejected":7},y=n=>{const o=x[n];n==="In Progress Tickets"?i(`/assistantprogress/${o}`):n==="Completed Tickets"?i(`/assistantview/${o}`):n==="Reopen"?i(`/assistantview/${o}`):o&&i(`/rolestats/${o}`)};return t("div",{children:t(B,{children:w.map((n,o)=>t(R,{sm:"6",md:"4",children:t(T,{className:"ticket-card bg-white",onClick:()=>y(n.label),style:{borderRadius:"30px"},children:a(N,{children:[a("div",{className:"d-flex justify-content-between",children:[a(H,{tag:"h6",className:"pe-auto",style:{fontSize:"16px",color:"#202224"},children:[n.label,t("h3",{className:"mt-2",style:{fontSize:"35px",fontWeight:"bold"},children:n.value})]}),n.img&&t("img",{src:n.img,alt:"Icon",style:{width:60,height:60,marginLeft:"10px"}})]}),a("div",{className:"d-flex align-items-center",children:[n.trend==="up"&&t(Q,{size:16,style:{color:"#00B69B"}}),n.trend==="down"&&t(X,{size:16,style:{color:"#F93C65"}}),a("span",{className:"ms-1",style:{color:n.trend==="up"?"#00B69B":n.trend==="down"?"#F93C65":"#202224",fontSize:"16px",fontWeight:"bold"},children:[n.percentage,"%"]}),n.trend!=="neutral"&&t(W,{className:" ms-1",style:{fontSize:"16px",color:"#202224"},children:n.trend==="up"?"Up from yesterday":"Down from yesterday"})]})]})})},o))})})}z.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;const le=()=>{const e=C();c.exports.useState(!1),c.exports.useState([]);const[l,i]=c.exports.useState(""),[u,D]=c.exports.useState("newest"),[w,x]=c.exports.useState([]);c.exports.useState(!1);const[y,d]=c.exports.useState(!1),p=async()=>{d(!0);try{const r=localStorage.getItem("authToken"),s=localStorage.getItem("user_id");if(!r){e("/login"),console.error("No token found, please login.");return}const g=await S.get(`https://bapi.reownlogics.com/api/help-desk?assigned_to_id=${s}`,{headers:{Authorization:`Bearer ${r}`}});let n=g.data;n.sort((o,b)=>new Date(b.created_at)-new Date(o.created_at)),x(n.slice(0,5)),console.log("employee data data",g.data)}catch(r){console.error("Error fetching employee data: ",r)}finally{d(!1)}};c.exports.useEffect(()=>{p()},[]);const m=(r,s)=>u==="newest"?new Date(s.createdAt)-new Date(r.createdAt):u==="oldest"?new Date(r.createdAt)-new Date(s.createdAt):0,f=w.filter(r=>r.title.toLowerCase().includes(l.toLowerCase())).sort(m),[h,k]=c.exports.useState(!1),_=()=>{k(!h)};return y?a("div",{className:"d-flex justify-content-center align-items-center fs-3",style:{height:"calc(100vh - 170px)"},children:[t($,{}),t("span",{className:"fs-2",style:{paddingBottom:"6px",paddingLeft:"5px"}})]}):a("div",{children:[t(ee,{}),t("div",{className:"d-flex justify-content-end align-items-center",children:t(F,{isOpen:h,toggle:_,refreshTickets:p})}),t(te,{}),a(T,{className:"bg-white ticket-card",style:{borderRadius:"30px"},children:[a("div",{className:"p-2 d-flex justify-content-between align-items-center",children:[t("div",{children:t("h3",{children:"Recent Ticket"})}),a("div",{className:"d-flex align-items-center justify-content-end",children:[a(j,{className:"mr-3",children:[t(A,{children:t(L,{size:16})}),t(M,{placeholder:"Search by name",value:l,onChange:r=>i(r.target.value)})]}),t(I,{to:"/allassistanttickets",style:{width:"50%"},className:"ms-1 viewall",children:"View All"})]})]}),t(N,{children:a(E,{responsive:!0,className:"table-ticket",children:[t("thead",{children:a("tr",{children:[t("th",{children:"Name"}),t("th",{children:"Description"}),t("th",{children:"Department"}),t("th",{children:"Created at"}),t("th",{children:"Requested Time"}),t("th",{children:"Actions"})]})}),t("tbody",{children:f.map(r=>a("tr",{children:[t("td",{children:r.title}),t("td",{children:(r==null?void 0:r.description.length)>3?`${r.description.slice(0,30)}...`:r.description||""}),t("td",{children:r.department.name}),t("td",{children:t("span",{style:{background:"rgba(58, 151, 76, 0.1)",padding:"10px",borderRadius:"100px",color:"#3A974C"},children:v(r.created_at).format("YYYY-MM-DD ")})}),t("td",{children:t("span",{children:v(r.created_at).format("hh:mm:ss A")})}),t("td",{children:a(P,{children:[t(O,{className:"pe-1",tag:"span",children:t(Y,{size:15})}),t(G,{end:!0,children:t(U,{onClick:()=>e(`/ticket-detail/${r.id}`),children:t("span",{className:"align-middle ms-50",children:"Detail"})})})]})})]},r.id))})]})})]})]})};export{le as default};
