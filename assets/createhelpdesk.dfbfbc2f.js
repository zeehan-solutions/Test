import{r as o,v as s,j as t,K as q}from"./index.021d50c3.js";import{s as j,M as I,o as M,k as B,R as L,c as w,L as i,h as c,p as P,m as z}from"./App.1f34475c.js";const H=j.button`
  background-color: #0C1539 !important;
  width: 200px;
  padding: 10px;
  color: white;
  cursor: pointer;
  border-radius: 10px!important;
  transition: background-color 0.3s;

  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,W=({isOpen:F,toggle:x,refreshTickets:C})=>{const[d,f]=o.exports.useState(""),[T,p]=o.exports.useState([]),[m,y]=o.exports.useState(""),[h,D]=o.exports.useState("No"),[u,N]=o.exports.useState(""),[g,b]=o.exports.useState(""),[n,U]=o.exports.useState({}),[k,v]=o.exports.useState({}),R=e=>{y(e),console.log("File selected:",e)},A=()=>{let e={};return d.trim()||(e.requestTitle="Request title is required."),g||(e.selectedDepartment="Please select a department."),u.trim()||(e.description="Description is required."),U(e),Object.keys(e).length===0};o.exports.useEffect(()=>{(async()=>{var l;const a=localStorage.getItem("authToken");if(!a){console.error("User token is missing");return}try{const r=await q.get("https://bapi.reownlogics.com/api/department",{headers:{Authorization:`Bearer ${a}`}});console.log("API Response:",r.data),Array.isArray(r.data)?p(r.data):(console.error("Unexpected API response format:",r.data),p([]))}catch(r){console.error("Error fetching departments:",((l=r.response)==null?void 0:l.data)||r.message),p([])}})()},[]);const E=async()=>{var l;if(!A())return;const e=localStorage.getItem("authToken");if(!e){console.error("User token is missing");return}const a=new FormData;a.append("title",d),a.append("department_id",Number(g)),a.append("description",u),h==="Yes"&&m&&(a.append("attachments[]",m),console.log("File uploaded:",m));for(let r of a.entries())console.log(r[0],r[1]);try{const r=await q.post("https://bapi.reownlogics.com/api/help-desk/store",a,{headers:{Authorization:`Bearer ${e}`}});console.log("Success:",r.data),C(),x()}catch(r){console.error("Error submitting the form:",((l=r.response)==null?void 0:l.data)||r.message),v(r.response.data)}},S=()=>{v({}),f(""),b(""),y(""),D("No"),N(""),x()};return s(I,{isOpen:F,toggle:S,size:"lg",children:[t(M,{toggle:S}),t("h4",{className:"text-center mb-2",children:"Help Desk"}),s(B,{children:[s(L,{children:[s(w,{md:6,children:[s(i,{children:["Request Title",t("span",{className:"text-danger",children:"*"})]}),t(c,{type:"text",placeholder:"Eg. Landing Page Design",value:d,onChange:e=>f(e.target.value)}),n.requestTitle&&t("small",{className:"text-danger",children:n.requestTitle})]}),s(w,{md:6,children:[s(i,{children:["Type of Request",t("span",{className:"text-danger",children:"*"})]}),s(c,{type:"select",value:g,onChange:e=>b(e.target.value),children:[t("option",{value:"",children:"Select Department"}),T.map(e=>t("option",{value:e.id,children:e.name},e.id))]}),n.selectedDepartment&&t("small",{className:"text-danger",children:n.selectedDepartment}),k.message&&t("p",{className:"text-danger",children:k.message})]})]}),t(i,{className:"mt-1",children:"Do you want to upload a file to explain the query more?"}),s(c,{type:"select",value:h,onChange:e=>D(e.target.value),children:[t("option",{children:"No"}),t("option",{children:"Yes"})]}),h==="Yes"&&t("div",{className:"mt-2",children:t(P,{onFileUpload:R})}),s(i,{className:"mt-1",children:["Description",t("span",{className:"text-danger",children:"*"})]}),t(c,{type:"textarea",placeholder:"Write your query here...",value:u,onChange:e=>N(e.target.value)}),n.description&&t("small",{className:"text-danger",children:n.description})]}),s(z,{className:"d-flex flex-column justify-content-center",children:[t(H,{onClick:E,children:"Submit"}),t("p",{className:"text-center mt-1 mb-2",children:"Never submit passwords or credit cards details through Workforms"})]})]})};export{W as C};
