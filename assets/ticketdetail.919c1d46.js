import{a5 as F,r,a6 as X,v as t,j as e,B as J,K as k,F as B}from"./index.0c706ca6.js";import{h as V,M,n as q,k as L,L as U,g as R,l as ae,s as Q,Z as se,R as re,c as G,C as P,$ as oe,a0 as ne,K as le,H as ce,a1 as Y,a2 as z}from"./App.dac02815.js";import{F as ie}from"./FormGroup.f1724220.js";/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var de=V("outline","send","IconSend",[["path",{d:"M10 14l11 -11",key:"svg-0"}],["path",{d:"M21 3l-6.5 18a.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a.55 .55 0 0 1 0 -1l18 -6.5",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.29.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var me=V("outline","star","IconStar",[["path",{d:"M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z",key:"svg-0"}]]);const he=({isOpen:A,toggle:i,onSubmit:x})=>{const{id:N}=F(),[d,l]=r.exports.useState(0),[m,s]=r.exports.useState(""),[f,c]=r.exports.useState(!1),p=X();r.exports.useEffect(()=>{A||(l(0),s(""),c(!1))},[A]);const v=n=>{l(n+1)},y=async()=>{if(!(d===0||!m)){try{const n=localStorage.getItem("authToken");if(!n){console.error("No token found, redirecting to login."),p("/login");return}const g=await k.post("https://bapi.reownlogics.com/api/help-desk/comments",{help_desk_id:N,rating:d,comment:m,reopen:f},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});console.log("rating Response:",g.data)}catch(n){console.error("API error:",n)}i()}};return t(M,{isOpen:A,toggle:i,centered:!0,children:[e(q,{toggle:i,children:"Rating"}),t(L,{children:[t(U,{className:"mt-2",children:["Rating",e("span",{className:"text-danger",children:"*"})]}),e("div",{className:"d-flex gap-1",children:[...Array(5)].map((n,g)=>e(me,{size:24,className:g<d?"text-warning":"text-muted",onClick:()=>v(g),style:{cursor:"pointer"}},g))}),e("small",{className:"text-muted",children:"Rate the solution you received for the ticket."}),t(U,{className:"mt-2",children:["Comment",e("span",{className:"text-danger",children:"*"})]}),e(R,{type:"textarea",placeholder:"Write your comment here...",value:m,onChange:n=>s(n.target.value)}),t(ie,{check:!0,className:"mt-2",children:[e(R,{type:"checkbox",id:"confirmCheckbox",checked:f,onChange:n=>c(n.target.checked)}),e(U,{for:"confirmCheckbox",check:!0,children:"Reopen Ticket"})]})]}),e(ae,{children:e(J,{color:"primary",onClick:y,disabled:d===0||!m,children:"Submit"})})]})},D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFPSURBVHgBpVO7boNAEASDZfPoeNVJbX9CmqSOqzT+Cvqkzge4T+/effqkDk2aUIMQEhIg8RBkFh8IXYhdsBJes+zNzs3NCcLMEKeKjuNodV1vRFG8pfe2bX9kWfaCIMj4XokvmKa5w4IX/LUBELLyHWpPqqpqeZ57/zKwLMttmsYuiuKQpmnIsbLBygVQGMfxQZiYvDcM45VnQ8+4Rj3j2qLfM9IDTeZwNfYMAS2oZ8/WnAGqqtqCWsDTngoIGZKoJHIH2KEsFjdI3tQCNG9oe+w1i6LoBHGpl07oU740Dcw+lsvlpZYzAyjvA/WR/5gkiY/kT7FCOnXs6QdTvsg0uq7bwpWg40SvQ8YaAJjDjqvVyr0GQF5Aeu9dOTgRDvsGg62iKDtJkryyLDN+8nq9fobgIYR86+t/7gJT/J4cx9Tu9szuxZFOYdw/+zLNjl+Rk58LkXmejwAAAABJRU5ErkJggg==",pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAOuSURBVHgBtVdNSFRRFL53TJ38G8VMCiERA3/RpESJHAMxIkoQUvGnhUju2liuBHdKGuimQEERUVqIC120GBQKakZFY0BamCQy1UK00dHRGXXm3b6TP8wb572cHz94c99975577jnnO+e84UwZvKWl5XZWVtang4ODy8wPhIWFHc7Pz9/r7++fw1T4WqNRkRe5ubkz/ioluN3u8OLiYpPaGkXFVVVV9x0Oh9rBVOF0OnlNTY1e6f0lH884/bhcLhYsYLniwc+8GB8fN2IQGoAFCSHEPyMmJye/euuSTUpLSzPgoiK6j4mJ+QFBwQIEyW5ubv6ke7vdfqupqemGomLE9fXOzo4oKyvTDQ0NWRITE5chLzH/ISD7fXp6ejk1NVVrs9lYdnZ2j+cCWYzB4JTIyEiO061MTU1dra6uzqioqChMSkrKOa/15N64uDhjb2/vEhnW0dGxQYoRuRRFxew456xWa8Lo6Oifurq6+ImJiVk8mmV+gizt7Oy0wN1RnPMz732xmmEh397e1vX19QnEmhhu9yWshIiICC3kw7a2triS3CW1DSRJYtiAbmOYH9jd3f3vmnOnTBAED1gx8UpotdoPw8PDN8PDwwNhuX+KFxcXH6ytrT2Lj4+3NTY2PjaZTCvR0dEazxNh/mt/f59q+ulF86ioKAdTaBAExRijwwij0ThnNpspyKO4OJi+CpayE8IgbXh9fT0VBl9e4IODgxIO4Z9i1Fne2tq6UFtbm06bjI2NvV1fX7/uyVLkpwTmL4D1q17ilA13iGQBsRobp6LDFJaUlNyFy5/DC/J6C4D5+RjyvWX39vaYWgqqKqa99Xr9DDEaSlkooUqu2NhYiqOAUjdGFw7gZhetGGnDQByOsqlBbBswahMSEhwsRFB0NdJCgDivmpub37S1tb1PT0+PROeK9lyD+EoojwYw3ez5nNIM5CpFjIuUaqaiYhJAa+vCbTfN29vbP6OvytbodDoNvPKI+U4nNjAwIGAA81cx6+rqusKOwiEaGhoKR0ZGJFh9uoZ6N5658G3220ucCss1aodKUGO1yMvLyykvL09MS0trQrl8wo4qkafr+PFBUryF1ZSqKqaGXlBQ8JEsR/URKCSHntYGC423Mnb2ADRwVDIWSnhXom/sggADljznsnKE7PiSmZnZwuRxDAm6u7v1iLvzZC6z2GAwbKBIvINbQ9JzCZTrycnJPRaLRUYQ78oloSm8wKKnIJWVBQlUP3w3Wh9WVla+xFT21+QvpMOy7PiWFOsAAAAASUVORK5CYII=",ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQPSURBVHgBxVZNSFRRFL7vzYyOPzNqQ6bppl0DJWGbFIQUdJGglJT4L/mDQouRgtoILQqxSdwY4hApOiIkbtRNaD8kaUYLMVw1CCY0jj/Z+DP+zbzXdwbf8HzN5DiSHhjmvnPPPd+553z33MtYaMJ1d3fbrVbrD4x5FoKEtKi5ublyY2PjrNPpTDKbzXcoEHZEUR3BlsvLyztfXl5+PyEh4bnH41FxkOjo6JsZGRnazc1N2/z8/DrsxKCcKb75lpYW08DAgHV8fHxRPgHd9uLiYnggR6IosqSkpI38/HydXJ+TkxNfWFh4t6qq6hk+BR+Q3AgGVyMiIp6bTKYFRVDcysqKCbsU/gHsQWCPFetUNTU1jp2dnacNDQ1Guf0B4IKCgi+UPoCwzs7OV3K/tbW1FqS4W6St/Q0qxsfHdwKklclSDfK9WF5eFuGST0tL+yZfw3V0dLTFxMTUokaa3d1dUYoYvgS9Xs9jl87h4eHr/f39U7QDi8Xihu4AsFqtJsJpbTbbTnFx8ZXc3NxRQRAMIKDPH0l4eDjTarVsa2vLwoeFhdWvrq4SKJMbUZTr6+vM5XLp4egB6dLT0w1wqNwwc7vdLDExUU9jEO0h2H4GoAf8kSDlDHM0rOHb2tp0iMLDAojBYNisrKysoLHRaNQTcFxcnIiAnvI8b8a8Nzs6nS6BbOrr60uRdmcgf8Byg8BaiohDbdJSU1M/KY3gjJWWlhIPpLrx2NG5sbGxhf1vbyqzs7MTR0ZGHBhLG6AGI6B8fwFPT09nt7e3v1XvL9b5i26/lnIyCQC1K8xEgP5U6lgAQbo1NO9ldXJy8iWvNQgLQgloCgKNqXYshK5Ess8ZMTIyUoyNjfWWgxTgwmX69wIPDg6+BON+Tk1NGUtKStRlZWUq7NakUqm+HwbQ09Pzure393dKSkqULEgOpP26tLT0qKKiQlVUVMSPjo5eA8bs0NDQi5B3IxccL5FKgkyJCJpacFAtM6RLQpKmpqZ70pleW1vj6urqbgW79ljAqNcTaUyc2N7eXgl27bGA0WT00hhHT+zq6voQ7Fp1AD2flZV1Ac3C11jQ5tyTk5N0fonqPEj1CN3JxxGk3MGOErQ/Jfr3O4BmynVgOGtsbIx2OByu1tbWBtxiZqTXl7G9vT0HdL+kb8xx8LGAumf6w/Cbajjx+0BAiyTG0rlskYOSaDSaczj3RumHDFyEzfW+vj6Pvw0eq8bBCC4gvrq6OvPEgUlmZmZ+sJMGpjt4YmLCxk4aOCoqyq/+vwPjNlpmpwEMcn1kpwE8OztrZacBjEfiGxYsMHow+5fg3XTo1YeuJeD1+sZut28FDQx5r3w+41iIcOKiuOhiR2d6jd8kutRn5Q/6ibm5udt46t5gAe7nP86G9TmsiQ8FAAAAAElFTkSuQmCC",ue=Q.button`
  background-color: #253180 !important;
  width:100px;
  border-radius:10px!important;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s;
padding: 10px 10px;
  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;function Ae({isOpen:A,toggle:i,department:x,onUpdateStatus:N}){const{id:d}=F(),[l,m]=r.exports.useState(""),[s,f]=r.exports.useState(""),[c,p]=r.exports.useState(""),[v,y]=r.exports.useState(""),[n,g]=r.exports.useState(""),[S,I]=r.exports.useState(""),C=async h=>{if(h.preventDefault(),!l.trim()){y("Field is required");return}if(!s.trim()){g("Field is required");return}if(!c.trim()){I("Field is required");return}try{const b=await k.post("https://bapi.reownlogics.com/api/help-desk/assign",{assistant_id:l,help_desk_id:d,resolve_date:s,resolve_time:c},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`}});console.log("Manager assigned successfully:",b.data),N("accepted"),i()}catch(b){console.error("Error assigning manager:",b)}};return e("div",{children:t(M,{isOpen:A,toggle:i,centered:!0,children:[e(q,{toggle:i,className:"text-center"}),t(L,{className:"p-2",children:[e("h3",{className:"text-center",children:"Assign Task"}),t(R,{type:"select",name:"select",value:l,onChange:h=>m(h.target.value),id:"exampleSelect",children:[e("option",{value:"",children:"Select Manager"}),x.length>0?x.map((h,b)=>e("option",{value:h.id,children:h.name},b)):e("option",{disabled:!0,children:"No managers available"})]}),v&&t("small",{className:"text-danger",children:[v," "]}),e(R,{type:"date",className:"mt-1",value:s,onChange:h=>f(h.target.value),name:"select"}),n&&t("small",{className:"text-danger",children:[n," "]}),e(R,{type:"time",value:c,className:"mt-1",onChange:h=>p(h.target.value),name:"select"}),S&&t("small",{className:"text-danger",children:[S," "]}),e("div",{className:"text-center",children:e(ue,{type:"submit",color:"primary",className:"mt-2",onClick:C,children:"Assign"})})]})]})})}const Ne=Q.button`
  background-color: #253180 !important;
  width:100px;
  border-radius:10px!important;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s;
padding: 10px 10px;
  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`;function xe({isOpen:A,toggle:i,onUpdateStatus:x}){const[N,d]=r.exports.useState(""),[l,m]=r.exports.useState(""),{id:s}=F();return t(M,{isOpen:A,toggle:i,centered:!0,children:[e(q,{toggle:i,className:"text-center"}),e(L,{children:t("div",{children:[e("h2",{className:"text-center",children:"Reject Task"}),e("p",{className:"text-center",children:"Please provide a reason for rejection"}),e(R,{type:"textarea",value:N,onChange:c=>d(c.target.value),name:"text",id:"exampleText"}),l&&t("small",{className:"text-danger",children:[l," "]}),e("div",{className:"text-center",children:e(Ne,{type:"submit",onClick:async c=>{if(c.preventDefault(),!N.trim()){m("Reason is required");return}try{const p=await k.post("https://bapi.reownlogics.com/api/help-desk/reject",{reason_of_rejection:N,help_desk_id:s},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")}`}});x("rejected"),console.log("Task rejected successfully:",p.data),i(),d(""),setError("")}catch(p){console.error("Error rejecting task:",p)}},color:"danger",className:"mt-2",children:"Reject"})})]})})]})}const W=Q.button`
  background-color: #253180 !important;
  width:100px;
  border-radius:10px!important;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s;
padding: 10px 10px;
  &:hover {
    background-color: #1a2447 !important; /* Lighter shade on hover */
  }
`,fe=()=>{var O;const[A,i]=r.exports.useState([]),[x,N]=r.exports.useState(!1),d=()=>N(!x),{id:l}=F(),m=X(),[s,f]=r.exports.useState(null),[c,p]=r.exports.useState("");r.exports.useState(!1);const[v,y]=r.exports.useState([]),[n,g]=r.exports.useState(""),[S,I]=r.exports.useState(!1),[C,h]=r.exports.useState(!1),b=()=>h(!C),K=()=>I(!S),T=localStorage.getItem("user_role");console.log("user role ",T);const H=async()=>{try{const a=localStorage.getItem("authToken");if(!a){console.error("No token found, redirecting to login."),m("/login");return}const o=await k.get(`https://bapi.reownlogics.com/api/help-desk?id=${l}`,{headers:{Authorization:`Bearer ${a}`}});console.log("Ticket details:",o.data),f(o.data),p(o.data.status);const w=o.data.department_id;console.log("Department ID:",w),Z(w);const u=o.data.comments||[];y(u)}catch(a){console.error("API error:",a)}};r.exports.useEffect(()=>{H()},[c]);const Z=async a=>{try{console.log("Fetching managers for department:",a);const o=localStorage.getItem("authToken");if(!o){console.error("No token found, redirecting to login."),m("/login");return}const w=`http://bapi.reownlogics.com/api/department/hiring_leads?department_id=${a}`,u=await k.get(w,{headers:{Authorization:`Bearer ${o}`}});console.log("API department Response:",u.data),Array.isArray(u.data)?i(u.data):Array.isArray(u.data.department)?i(u.data.department):console.error("Unexpected API response structure:",u.data)}catch(o){console.error("API error:",o)}},E=a=>{p(a),console.log("new status",a)},_=`https://bapi.reownlogics.com/api/help-desk/${l}`;r.exports.useEffect(()=>{if(!l)return;const a=localStorage.getItem("authToken");k.get(_,{headers:{Authorization:`Bearer ${a}`}}).then(o=>{const w=o.data.comments||[];console.log("Fetched comments:",w);const u=w.map(j=>({name:j.comment_by_name||"Unknown User",text:j.comment,date:new Date(j.created_at).toLocaleString(),avatar:se}));y(u)}).catch(o=>console.error("Error fetching comments:",o))},[l]);const $=async()=>{if(console.log("Submit button clicked"),n.trim())try{const a=localStorage.getItem("authToken"),o=await k.post("https://bapi.reownlogics.com/api/help-desk/comments",{help_desk_id:l,comment:n},{headers:{Authorization:`Bearer ${a}`}});y([{name:"You",text:n,date:"Just now",avatar:"https://via.placeholder.com/40"},...v]),g(""),console.log("Comment posted successfully:",o.data)}catch(a){console.error("Error posting comment:",a)}},ee=async a=>{console.log("Submitting Rating:",a)},te=async()=>{console.log("clicked");try{const a=localStorage.getItem("authToken");if(!a){console.error("No token found, redirecting to login."),m("/login");return}const o=await k.post(`https://bapi.reownlogics.com/api/help-desk/resolved?help_desk_id=${l}`,{headers:{Authorization:`Bearer ${a}`}});console.log("resolve",o.data),p("resolved")}catch(a){console.error("API error:",a)}};return e("div",{className:"container py-6 my-4",children:t(re,{children:[e(G,{xl:"8",lg:"8",sm:"12",xs:"12",children:t(P,{className:"bg-white p-2",style:{borderRadius:"20px"},children:[e("div",{className:"d-flex justify-content-between alig-item-center mobile-column",children:e("span",{style:{fontSize:"20px"},children:(s==null?void 0:s.title)||"Loading..."})}),e("div",{className:"mt-1",children:e("p",{children:(s==null?void 0:s.description)||"No description available"})}),t("div",{className:" gap-2 mt-2",children:[e("h6",{children:"Uploads"}),e(oe,{})]}),e("h6",{className:"mt-4",children:"Comments"}),e(ne,{children:e(le,{style:{maxHeight:"300px",overflowY:"auto"},children:v.length>0?v.map((a,o)=>t(ce,{className:"border-0",children:[t("div",{className:"d-flex align-items-center",children:[e("img",{src:a.avatar,alt:"avatar",className:"rounded-circle me-2",width:"40",height:"40"}),e("strong",{children:a.name}),e("span",{className:"mx-1",children:"\u2022"}),e("small",{className:"text-muted",children:a.date})]}),e("p",{className:"mt-1 mb-0",children:a.text})]},o)):e("p",{className:"text-muted text-center",children:"No comments yet."})})}),t("div",{className:"d-flex align-items-center gap-2 mb-3 mt-2",children:[e(R,{type:"text",placeholder:"Write a comment...",value:n,onChange:a=>g(a.target.value)}),e(J,{color:"primary",onClick:$,children:e(de,{size:16})})]})]})}),e(G,{xl:"4",lg:"4",sm:"12",children:t(P,{className:"bg-white p-2 rounded-4",children:[T==="manager"&&e("div",{className:"rounded p-1 mb-1 d-flex",style:{background:"#F3F3F3"},children:t(B,{children:[c==="pending"&&t(B,{children:[t("div",{className:"d-flex align-item-center mt-2",children:[e("img",{src:Y,alt:"calendar",width:"20",height:"20"}),e("span",{className:"ms-1",children:"Assigned to:"})]}),t("div",{className:"d-flex align-item-center ms-1 mt-1",children:[e(W,{onClick:K,children:"Assign"}),e(Ae,{isOpen:S,toggle:K,department:A,onUpdateStatus:E})]})]}),c==="accepted"&&t(B,{children:[t("div",{className:"d-flex align-items-center mt-1",children:[e("img",{src:Y,alt:"calendar",width:"20",height:"20"}),e("span",{className:"ms-1 text-success border-success p-1 rounded",children:"Assigned"})]}),t("div",{className:"d-flex align-items-center ms-1 mt-1",children:[e(W,{onClick:b,className:"ms-1 p-1",children:"Reject"}),e(xe,{isOpen:C,toggle:b,onUpdateStatus:E})]})]}),c==="rejected"&&e("span",{className:"text-danger fw-bold ms-1",children:"Rejected"})]})}),T==="assistant_manager"&&e("div",{className:"rounded p-1 mb-1 d-flex",style:{background:"#F3F3F3"},children:t("div",{className:"d-flex align-items-center",children:[e("img",{src:D,alt:"calendar",width:"20",height:"20"}),t("span",{className:"ms-1",children:["Resolve:",e("button",{type:"button",class:"btn btn-outline-success ms-1",onClick:te,children:"Resolve "})]})]})}),e("div",{className:"rounded p-1 mb-1",style:{background:"#F3F3F3"},children:t("div",{className:"d-flex align-items-center",children:[e("img",{src:z,alt:"calendar",width:"20",height:"20"}),t("span",{className:"ms-1",children:["Requested Date: ",((O=s==null?void 0:s.created_at)==null?void 0:O.split("T")[0])||"N/A"]})]})}),e("div",{className:"rounded p-1 mb-1",style:{background:"#F3F3F3"},children:t("div",{className:"d-flex align-item-center",children:[e("img",{src:z,alt:"calendar",width:"20",height:"20"}),t("span",{className:"ms-1",children:["Resolved Date: ",(s==null?void 0:s.resolve_date)||"Not Resolved"]})]})}),e("div",{className:"rounded p-1 mb-1",style:{background:"#F3F3F3"},children:t("div",{className:"d-flex align-item-center",children:[e("img",{src:D,alt:"clock",width:"20",height:"20"}),t("span",{className:"ms-1",children:["Resolved Time:  ",(s==null?void 0:s.resolve_time)||"Not Resolved"]})]})}),T==="employee"&&c==="resolved"&&e("div",{className:"rounded p-1 mb-1",style:{background:"#F3F3F3",cursor:"pointer"},onClick:d,children:t("div",{className:"d-flex align-items-center",children:[e("img",{src:ge,alt:"status",width:"20",height:"20"}),e("span",{className:"ms-1",children:"Rating: "}),e("span",{className:"ms-1",children:"Click to Rate"})]})}),e(he,{isOpen:x,toggle:d,onSubmit:ee}),e("div",{className:"rounded p-1 mb-1",style:{background:"#F3F3F3"},children:t("div",{className:"d-flex align-items-center",children:[e("img",{src:pe,alt:"status",width:"20",height:"20"}),t("span",{className:"ms-1",children:["  ",s?t("span",{children:["Status: ",s==null?void 0:s.status]}):e("p",{children:"Loading..."})," "]})]})}),e("div",{className:"rounded p-1 mb-1",style:{background:"#F3F3F3"},children:t("div",{className:"d-flex align-item-center",children:[e("img",{src:D,alt:"clock",width:"20",height:"20"}),e("span",{className:"ms-1",children:"Time for Request to Resolution:   36H 27M"})]})})]})})]})})};export{fe as default};
